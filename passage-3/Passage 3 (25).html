<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
            overflow: hidden;
        }

        .loading-screen {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #f9fafb;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 9999;
        }

        .loading-content {
            text-align: center;
        }

        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: #2563eb;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .loading-title {
            font-size: 1.2rem;
            color: #6b7280;
            margin-bottom: 20px;
        }

        .loading-subtitle {
            font-size: 1rem;
            color: #9ca3af;
        }

        .start-screen {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #f9fafb;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 9998;
        }

        .start-content {
            text-align: center;
        }

        .start-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #111827;
            margin-bottom: 24px;
        }

        .start-subtitle {
            color: #6b7280;
            margin-bottom: 24px;
        }

        .start-button {
            padding: 12px 32px;
            background-color: #2563eb;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .start-button:hover {
            background-color: #1d4ed8;
        }

        .hidden {
            display: none !important;
        }

        .container {
            display: flex;
            flex-direction: column;
            height: 100vh;
            width: 100vw;
            background: white;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        header {
            background-color: #ffffff;
            color: #333;
            padding: 8px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 100;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            flex-shrink: 0;
            border-bottom: 1px solid #e2e8f0;
        }

        .passage-info {
            font-size: 0.9rem;
            font-weight: 500;
            color: #2d3748;
        }

        .timer {
            background-color: rgba(255, 193, 193, 0.5);
            padding: 6px 12px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.3s;
            min-width: 80px;
            text-align: center;
            font-size: 0.9rem;
            color: #c53030;
            border: 1px solid rgba(255, 120, 120, 0.3);
        }

        .timer.warning {
            color: #9b2c2c;
            background-color: rgba(254, 178, 178, 0.7);
            border-color: rgba(245, 101, 101, 0.5);
        }

        .logo-area {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background-color: #007bff;
            color: white;
            text-decoration: none;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0, 123, 255, 0.3);
            cursor: pointer;
        }

        .logo-area:hover {
            background-color: #0056b3;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 123, 255, 0.4);
        }

        .logo-area i {
            font-size: 1.1rem;
        }

        .progress-container {
            background-color: #f8f9fa;
            padding: 4px 20px;
            z-index: 100;
            flex-shrink: 0;
            border-top: 1px solid #e2e8f0;
        }

        .progress-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 5px;
        }

        .progress-items {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }

        .nav-buttons {
            display: flex;
            gap: 6px;
        }

        .progress-item {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #4a5568;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.95rem;
            border: 1px solid #cbd5e0;
        }

        .progress-item.current {
            background-color: #4299e1;
            color: white;
            transform: scale(1.1);
            border-color: #2b6cb0;
        }

        .progress-item.answered {
            background-color: #9ae6b4;
            color: #22543d;
            border-color: #68d391;
        }

        .progress-item.correct {
            background-color: #48bb78;
            color: white;
            border-color: #38a169;
        }

        .progress-item.incorrect {
            background-color: #fed7d7;
            color: #c53030;
            border-color: #feb2b2;
        }

        .progress-item:hover {
            background-color: #cbd5e0;
            transform: scale(1.05);
        }

        .btn {
            padding: 6px 14px;
            border: 1px solid #cbd5e0;
            border-radius: 4px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.95rem;
            background-color: #f7fafc;
            color: #4a5568;
        }

        .btn i {
            font-size: 1rem;
        }

        .btn:hover {
            background-color: #edf2f7;
            border-color: #a0aec0;
        }

        .btn-primary {
            background-color: #f7fafc;
            color: #4a5568;
            border: 1px solid #cbd5e0;
        }

        .btn-primary:hover {
            background-color: #edf2f7;
            border-color: #a0aec0;
        }

        .btn-secondary {
            background-color: #f7fafc;
            color: #4a5568;
            border: 1px solid #cbd5e0;
        }

        .btn-secondary:hover {
            background-color: #edf2f7;
            border-color: #a0aec0;
        }

        .btn-submit {
            background-color: #48bb78;
            color: white;
            font-weight: 900;
            border: 1px solid #38a169;
        }

        .btn-submit:hover {
            background-color: #38a169;
            border-color: #2f855a;
        }

        .btn-submit:disabled {
            background-color: #9ae6b4;
            color: #718096;
            cursor: not-allowed;
            border: 1px solid #68d391;
        }

        .main-content {
            display: flex;
            flex: 1;
            overflow: hidden;
            position: relative;
        }

        .passage-container {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background-color: #fafafa;
            position: relative;
        }

        .resizer {
            width: 4px;
            background-color: #cbd5e0;
            cursor: col-resize;
            position: relative;
            transition: background-color 0.2s;
        }

        .resizer:hover {
            background-color: #a0aec0;
        }

        .resizer::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 30px;
            height: 60px;
            background-color: rgba(203, 213, 224, 0.5);
            border-radius: 4px;
            pointer-events: none;
        }

        .questions-container {
            width: 40%;
            padding: 20px;
            overflow-y: auto;
            background-color: white;
            border-left: 1px solid #e2e8f0;
        }

        .passage {
            max-width: 800px;
            margin: 0 auto;
        }

        .passage h2 {
            color: #2d3748;
            margin-bottom: 20px;
            font-size: 1.4rem;
        }

        .passage-content p {
            margin-top: 15px;
            margin-bottom: 20px;
            text-align: justify;
        }

        .passage h2 {
            color: #2d3748;
            margin-bottom: 20px;
            font-size: 1.4rem;
        }

        .passage p {
            margin-top: 20px;
            margin-bottom: 25px;
            text-align: justify;
        }

        .question-section {
            max-width: 800px;
            margin: 0 auto;
        }

        .section-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 20px;
            padding-bottom: 8px;
            border-bottom: 2px solid #e2e8f0;
        }

        .question {
            margin-bottom: 25px;
            padding: 6px;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            background-color: #ffffff;
            transition: box-shadow 0.2s;
        }

        .question:hover {
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .question-text {
            font-weight: 500;
            margin-bottom: 12px;
            color: #2d3748;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .option {
            display: flex;
            align-items: center;
            padding: 8px 12px;
            border: 1px solid #e2e8f0;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.9rem;
        }

        .option:hover {
            background-color: #f7fafc;
            border-color: #cbd5e0;
        }

        .option input {
            margin-right: 2px;
            width: 16px;
            height: 16px;
        }

        .input-field {
            padding: 8px 10px;
            border: 1px solid #e2e8f0;
            border-radius: 4px;
            width: 20%;
            margin-top: 5px;
            font-size: 0.9rem;
        }

        .input-field:focus {
            border-color: #4299e1;
            outline: none;
            box-shadow: 0 0 0 2px rgba(66, 153, 225, 0.2);
        }

        select.input-field {
            padding: 8px 10px;
            border: 1px solid #e2e8f0;
            border-radius: 4px;
            width: 20%;
            margin-top: 5px;
            font-size: 0.9rem;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            font-size: 0.9rem;
        }

        th,
        td {
            border: 1px solid #e2e8f0;
            padding: 10px;
            text-align: left;
        }

        th {
            background-color: #f1f5f9;
            font-weight: 600;
            color: #2d3748;
        }

        .answer-indicator {
            background-color: #e6fffa;
            border: 1px solid #38b2ac;
            padding: 10px;
            border-radius: 4px;
            margin-top: 10px;
            font-size: 0.9rem;
        }

        .answer-indicator.correct {
            background-color: #e6fffa;
            border-color: #38b2ac;
            color: #234e52;
        }

        .answer-indicator.incorrect {
            background-color: #fed7d7;
            border-color: #fc8181;
            color: #742a2a;
        }

        .question-group {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .question-group-title {
            font-weight: 600;
            margin-bottom: 12px;
            color: #2d3748;
            font-size: 1rem;
        }

        .highlight {
            background-color: #ffff00;
            cursor: pointer;
        }

        #highlight-btn,
        #remove-highlight-btn {
            position: absolute;
            z-index: 9999;
            display: none;
            padding: 6px 12px;
            font-size: 14px;
            border: 1px solid #888;
            border-radius: 4px;
            cursor: pointer;
            background-color: white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            width: 90%;
            max-width: 450px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .score-display {
            font-size: 2.2rem;
            font-weight: bold;
            margin: 20px 0;
            color: #2d3748;
        }

        .score-breakdown {
            margin: 20px 0;
            text-align: left;
        }

        .score-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #e2e8f0;
            font-size: 0.95rem;
        }

        .modal-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
        }

        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }

            .questions-container {
                width: 100%;
                border-left: none;
                border-top: 1px solid #e2e8f0;
            }

            .resizer {
                width: 100%;
                height: 4px;
                cursor: row-resize;
            }

            .resizer::before {
                width: 60px;
                height: 30px;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
            }

            .progress-item {
                width: 32px;
                height: 32px;
                font-size: 0.85rem;
            }

            .passage-info {
                font-size: 0.9rem;
            }

            header {
                flex-direction: column;
                gap: 10px;
                padding: 10px;
            }

            .logo-area {
                order: 1;
            }

            .passage-info {
                order: 2;
            }

            .timer {
                order: 3;
            }
        }

        @media (max-width: 480px) {
            .progress-item {
                width: 32px;
                height: 32px;
                font-size: 0.85rem;
            }

            .passage-info {
                font-size: 0.9rem;
            }
        }
    </style>
</head>


<body>
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-content">
            <div class="spinner"></div>
            <h2 class="loading-title">Your test will begin shortly</h2>
            <p class="loading-subtitle">Please wait</p>
        </div>
    </div>

    <!-- Start Screen -->
    <div id="startScreen" class="start-screen">
        <div class="start-content">
            <h1 class="start-title">IELTSwithJurabek</h1>
            <p class="start-subtitle">Ready to begin your reading test?</p>
            <button class="start-button" onclick="startTest()">Start Test</button>
        </div>
    </div>

    <!-- Test Container -->
    <div class="container hidden" id="testContainer">
        <header>
            <div class="passage-info">IELTSwithJurabek</div>
            <div class="timer">
                <i class="fas fa-clock"></i>
                <span>20:00</span>
            </div>
            <div class="logo-area" onclick="window.open('https://t.me/IELTSwithJurabek', '_blank')">
                <i class="fas fa-paper-plane"></i>
                <span>Click for more TESTS</span>
            </div>
            <div class="passage-info">Passage 3: The History of Chocolate</div>
        </header>

        <button id="highlight-btn" type="button">Highlight</button>
        <button id="remove-highlight-btn" type="button">Remove Highlight</button>

        <div class="main-content">
            <!-- Reading Passage -->
            <div class="passage-container" role="region" aria-label="Reading Passage">
                <h2 class="section-title">READING PASSAGE 3</h2>
                <div class="passage-content" id="passage3">
                    <h3>The History of Chocolate</h3>
                    <p id="A3"><span class="label">A</span> Chocolate is now perceived as a ubiquitous indulgence,
                        whether consumed as confectionery or a beverage, readily accessible in global markets. However,
                        it may come as a surprise that chocolate was once regarded as a commodity of extraordinary
                        value. The discovery of the cocoa tree, the source of chocolate, occurred approximately 2,000
                        years ago in the lush tropical rain forests of the Americas. The evolution of the chocolate —
                        from a regionally significant Mesoamerican drink to globally consumed confectionery — has been
                        shaped through cross-continental cultural exchanges and the successive influences of multiple
                        civilisations.</p>
                    <p id="B3"><span class="label">B</span> Historians suggest that the ancient Maya pioneered cocoa
                        tree cultivation in Mesoamerica, with evidence dating back approximately 2,000 years. They
                        transplanted cocoa trees from the dense rain forest into their domesticated gardens, where cocoa
                        beans were initially roasted and ground into a smooth paste. The paste was combined with spices
                        and water to produce unsweetened chocolate beverages. The Maya also employed a distinctive
                        technique of transferring the liquid back and forth between containers, generating a foamy layer
                        on the drink's surface.</p>
                    <p id="C3"><span class="label">C</span> Cocoa and chocolate were integral to Maya culture, commonly
                        depicted in their architectural structures and artistic works. While the aristocracy,
                        particularly the royal families, consumed chocolate during elaborate ceremonies, even less
                        privileged groups occasionally savoured the drink. Furthermore, cocoa beans served as a powerful
                        emblem of marital union and were ritually exchanged during wedding ceremonies.</p>
                    <p id="D3"><span class="label">D</span> The Aztec civilisation in Mexico regarded chocolate as a
                        prestigious commodity, despite being geographically unable to cultivate cocoa trees within their
                        heartland. Accordingly, they sourced cocoa beans through extensive trade networks, even
                        utilising them as currency for tax payments. Chocolate held an exclusive function within Aztec
                        imperial and religious ceremonies, where priests offered cocoa beans as divine offerings and
                        prepared sacred chocolate drinks. Due to the scarcity of cocoa beans, consumption remained
                        restricted to the societal elite, with historical accounts suggesting Emperor Montezuma consumed
                        up to 50 cups daily. Linguists trace the term 'chocolate' to the Aztec Nahuatl word xocolatl,
                        meaning 'bitter water' in the Nahuatl language, though some scholars argue that it has hybrid
                        origins combining Maya and Nahuatl linguistic elements.</p>
                    <p id="E3"><span class="label">E</span> In 1502, explorer Christopher Columbus introduced cocoa
                        beans to Spain after voyaging to Mesoamerica, and later Spanish explorer Hernán Cortés quickly
                        recognised the potential economic value of chocolate. Upon arriving in present-day Mexico in
                        1519, Cortés observed that chocolate beverages would appeal to the Spanish. After conquering the
                        Aztec Empire, Spanish forces exported confiscated cocoa supplies to Spain. In response to the
                        growing demand, Spain began cultivating cocoa trees in its American colonies. Spanish elite
                        first developed a taste for sweetened chocolate drinks, but the beverage rapidly spread across
                        Europe. England, the Netherlands, and France followed suit by establishing cocoa plantations in
                        their own colonies. By the 18th century, chocolate remained primarily a luxury restricted to the
                        affluent. However, the Industrial Revolution's technologies enabled mechanised production,
                        dramatically reducing costs and making chocolate available to a broader population.</p>
                    <p id="F3"><span class="label">F</span> Cocoa trees are cultivated across multiple countries in
                        Africa, Mesoamerica, and South America, thriving in cool, shaded environments within equatorial
                        zones. Despite widespread cultivation, cocoa farming remains labour-intensive, due to the trees'
                        requirement for specific water thresholds, temperature ranges, soil compositions, and protection
                        from environmental threats. Approximately five years after planting, cocoa trees begin to yield
                        large, pod-shaped fruits that grow on the trunk. These pods contain the beans used in chocolate
                        production. While several types of cocoa trees exist, the bulk of the chocolate is produced from
                        the seeds of the most commonly cultivated varieties. However, farmers opt to grow more
                        specialised types, such as Criollo or Trinitario, valued for distinctive flavour profiles.
                        Unexpectedly, cocoa trees grown on farms are more vulnerable to disease and pests than their
                        wild counterparts. Cocoa cultivation presents a strenuous endeavour for farmers, who sell their
                        harvests on futures markets, exposing their incomes to external market fluctuations.</p>
                    <p id="G3"><span class="label">G</span> The process of chocolate production involves a series of
                        steps, carried out in specialised factories where cocoa beans are meticulously processed.
                        Workers first sort, clean, and roast the beans before extracting the outer shells, leaving only
                        the inner nibs. These nibs are then ground into a dense paste known as chocolate liquor, which
                        is subsequently separated into two components: cocoa solids and cocoa butter. Following
                        standardised formulations, chocolate manufacturers blend the chocolate liquor with precise
                        ratios of sugar, milk, and cocoa butter. The resulting mixture, often referred to as the
                        'crumb', undergoes fine grinding to create a smooth consistency. Finally, the mixture is then
                        subjected to two additional processes — conching and tempering — before being placed into moulds
                        to create various forms, such as bars or other chocolate products.</p>
                    <p id="H3"><span class="label">H</span> Chocolate holds significant global economic value, with the
                        manufacturing industry generating over $5 billion annually from cocoa crops, and its reputation
                        remains most prominent in Europe and the United States. For instance, US cocoa product imports
                        reached $1.4 billion in 2005. On average, Americans consume over five kilogrammes of chocolate
                        per person each year. In addition, upscale chocolate boutiques, which offer premium chocolates,
                        have gained significant popularity. Many of these shops specialise in artisanal chocolates,
                        crafted with unique flavour profiles. Renowned chocolate brands such as Cadbury, Godiva, Lindt,
                        and Ferrero Rocher dominate the market. However, the cocoa and chocolate production sectors
                        often face challenges related to fair trade, sustainable development, and environmental
                        preservation. These issues are now being actively addressed by industry stakeholders, including
                        officials, activists, and researchers, who are working closely with farmers to promote faming
                        practices that foster sustainability and protect the environment.</p>
                </div>
            </div>

            <div class="resizer" id="resizer"></div>

            <!-- Questions -->
            <div class="questions-container" id="questions" role="region" aria-label="Questions">
                <h2 class="section-title">Questions 27-40</h2>
                <p>You should spend about 20 minutes on Questions 27–40, which are based on Reading Passage 3.</p>

                <div class="question-group">
                    <div class="question-group-title">Questions 27-31</div>
                    <p>Reading Passage 3 has eight paragraphs, A-H. Which paragraph contains the following information?
                        Choose the correct letter, A-H, in boxes 27-31.</p>
                    <p><strong>NB</strong> You may use any letter more than once.</p>
                    <div class="question" data-question="27">
                        <div class="question-text">27. The part of cocoa trees used for chocolate production</div>
                        <div class="options">
                            <label><input type="radio" name="q27" value="A"> A</label>
                            <label><input type="radio" name="q27" value="B"> B</label>
                            <label><input type="radio" name="q27" value="C"> C</label>
                            <label><input type="radio" name="q27" value="D"> D</label>
                            <label><input type="radio" name="q27" value="E"> E</label>
                            <label><input type="radio" name="q27" value="F"> F</label>
                            <label><input type="radio" name="q27" value="G"> G</label>
                            <label><input type="radio" name="q27" value="H"> H</label>
                        </div>
                    </div>
                    <div class="question" data-question="28">
                        <div class="question-text">28. Annual chocolate consumption per capita in the United States
                        </div>
                        <div class="options">
                            <label><input type="radio" name="q28" value="A"> A</label>
                            <label><input type="radio" name="q28" value="B"> B</label>
                            <label><input type="radio" name="q28" value="C"> C</label>
                            <label><input type="radio" name="q28" value="D"> D</label>
                            <label><input type="radio" name="q28" value="E"> E</label>
                            <label><input type="radio" name="q28" value="F"> F</label>
                            <label><input type="radio" name="q28" value="G"> G</label>
                            <label><input type="radio" name="q28" value="H"> H</label>
                        </div>
                    </div>
                    <div class="question" data-question="29">
                        <div class="question-text">29. The higher likelihood of cultivated cocoa trees being attacked by
                            insects</div>
                        <div class="options">
                            <label><input type="radio" name="q29" value="A"> A</label>
                            <label><input type="radio" name="q29" value="B"> B</label>
                            <label><input type="radio" name="q29" value="C"> C</label>
                            <label><input type="radio" name="q29" value="D"> D</label>
                            <label><input type="radio" name="q29" value="E"> E</label>
                            <label><input type="radio" name="q29" value="F"> F</label>
                            <label><input type="radio" name="q29" value="G"> G</label>
                            <label><input type="radio" name="q29" value="H"> H</label>
                        </div>
                    </div>
                    <div class="question" data-question="30">
                        <div class="question-text">30. A community which developed a preference for sweetened chocolate
                            beverages</div>
                        <div class="options">
                            <label><input type="radio" name="q30" value="A"> A</label>
                            <label><input type="radio" name="q30" value="B"> B</label>
                            <label><input type="radio" name="q30" value="C"> C</label>
                            <label><input type="radio" name="q30" value="D"> D</label>
                            <label><input type="radio" name="q30" value="E"> E</label>
                            <label><input type="radio" name="q30" value="F"> F</label>
                            <label><input type="radio" name="q30" value="G"> G</label>
                            <label><input type="radio" name="q30" value="H"> H</label>
                        </div>
                    </div>
                    <div class="question" data-question="31">
                        <div class="question-text">31. An approach by which ancient Mexicans could acquire cocoa beans
                        </div>
                        <div class="options">
                            <label><input type="radio" name="q31" value="A"> A</label>
                            <label><input type="radio" name="q31" value="B"> B</label>
                            <label><input type="radio" name="q31" value="C"> C</label>
                            <label><input type="radio" name="q31" value="D"> D</label>
                            <label><input type="radio" name="q31" value="E"> E</label>
                            <label><input type="radio" name="q31" value="F"> F</label>
                            <label><input type="radio" name="q31" value="G"> G</label>
                            <label><input type="radio" name="q31" value="H"> H</label>
                        </div>
                    </div>
                </div>

                <div class="question-group">
                    <div class="question-group-title">Questions 32-36</div>
                    <p>Choose <strong>TRUE</strong> if the statement agrees with the information given in the text,
                        choose <strong>FALSE</strong> if the statement contradicts the information, or choose
                        <strong>NOT GIVEN</strong> if there is no information on this.
                    </p>
                    <div class="question" data-question="32">
                        <div class="question-text">32. The Mayan ruling class forbade the use of cocoa and chocolate in
                            rituals.</div>
                        <div class="options">
                            <label><input type="radio" name="q32" value="TRUE"> TRUE</label>
                            <label><input type="radio" name="q32" value="FALSE"> FALSE</label>
                            <label><input type="radio" name="q32" value="NOT GIVEN"> NOT GIVEN</label>
                        </div>
                    </div>
                    <div class="question" data-question="33">
                        <div class="question-text">33. The Spanish explorer Hernán Cortés had made an investment in
                            chocolate and chocolate beverages.</div>
                        <div class="options">
                            <label><input type="radio" name="q33" value="TRUE"> TRUE</label>
                            <label><input type="radio" name="q33" value="FALSE"> FALSE</label>
                            <label><input type="radio" name="q33" value="NOT GIVEN"> NOT GIVEN</label>
                        </div>
                    </div>
                    <div class="question" data-question="34">
                        <div class="question-text">34. Wild cocoa trees are more susceptible to infectious diseases than
                            cultivated ones.</div>
                        <div class="options">
                            <label><input type="radio" name="q34" value="TRUE"> TRUE</label>
                            <label><input type="radio" name="q34" value="FALSE"> FALSE</label>
                            <label><input type="radio" name="q34" value="NOT GIVEN"> NOT GIVEN</label>
                        </div>
                    </div>
                    <div class="question" data-question="35">
                        <div class="question-text">35. During chocolate production, some of the seeds are discarded.
                        </div>
                        <div class="options">
                            <label><input type="radio" name="q35" value="TRUE"> TRUE</label>
                            <label><input type="radio" name="q35" value="FALSE"> FALSE</label>
                            <label><input type="radio" name="q35" value="NOT GIVEN"> NOT GIVEN</label>
                        </div>
                    </div>
                    <div class="question" data-question="36">
                        <div class="question-text">36. Chocolate enjoys more prestige in Europe and the United States
                            than in any other country.</div>
                        <div class="options">
                            <label><input type="radio" name="q36" value="TRUE"> TRUE</label>
                            <label><input type="radio" name="q36" value="FALSE"> FALSE</label>
                            <label><input type="radio" name="q36" value="NOT GIVEN"> NOT GIVEN</label>
                        </div>
                    </div>
                </div>

                <div class="question-group">
                    <div class="question-group-title">Questions 37-40</div>
                    <p>Complete the flow-chart below. Write <strong>NO MORE THAN TWO WORDS</strong> from the passage for
                        each answer.</p>
                    <p class="text-center font-bold">From Cocoa Beans to Chocolate</p>
                    <div class="question" data-question="37">
                        <div class="question-text">Seeds → classifying, cleaning, and roasting → stripping their <input
                                type="text" class="flow-input" name="q37" maxlength="30" placeholder="37"></div>
                    </div>
                    <div class="question" data-question="38">
                        <div class="question-text">Nibs → crushing → producing <input type="text" class="flow-input"
                                name="q38" maxlength="30" placeholder="38"></div>
                    </div>
                    <div class="question" data-question="39">
                        <div class="question-text">Mixing with measured quantities of substances such as sweeteners,
                            liquid dairy, and <input type="text" class="flow-input" name="q39" maxlength="30"
                                placeholder="39"></div>
                    </div>
                    <div class="question" data-question="40">
                        <div class="question-text">Crumb blending → crushing finely to obtain a smooth texture →
                            manufacturing diverse shapes of chocolate in <input type="text" class="flow-input"
                                name="q40" maxlength="30" placeholder="40"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="progress-container">
            <div class="progress-nav">
                <div class="progress-items" id="progress-items">
                    <div class="progress-item current" data-question="27">27</div>
                    <div class="progress-item" data-question="28">28</div>
                    <div class="progress-item" data-question="29">29</div>
                    <div class="progress-item" data-question="30">30</div>
                    <div class="progress-item" data-question="31">31</div>
                    <div class="progress-item" data-question="32">32</div>
                    <div class="progress-item" data-question="33">33</div>
                    <div class="progress-item" data-question="34">34</div>
                    <div class="progress-item" data-question="35">35</div>
                    <div class="progress-item" data-question="36">36</div>
                    <div class="progress-item" data-question="37">37</div>
                    <div class="progress-item" data-question="38">38</div>
                    <div class="progress-item" data-question="39">39</div>
                    <div class="progress-item" data-question="40">40</div>
                </div>
                <div class="nav-buttons">
                    <button class="btn btn-secondary" id="prev-btn" disabled><i class="fas fa-arrow-left"></i>
                        Previous</button>
                    <button class="btn btn-secondary" id="next-btn">Next <i class="fas fa-arrow-right"></i></button>
                    <button class="btn btn-submit" id="submit-btn">Submit Test <i
                            class="fas fa-paper-plane"></i></button>
                </div>
            </div>
        </div>
    </div>

    <!-- Results Modal -->
    <div class="modal" id="results-modal">
        <div class="modal-content">
            <h2>Test Results</h2>
            <div class="score-display" id="score-display">0/14</div>
            <div class="modal-buttons">
                <button class="btn btn-secondary" id="close-modal">Close</button>
                <button class="btn btn-primary" id="review-answers">Review Answers</button>
            </div>
        </div>
    </div>

    <script>
        // Correct Answers for Questions 27-40
        const correctAnswers = {
            q27: "F",
            q28: "H",
            q29: "F",
            q30: "E",
            q31: "D",
            q32: "FALSE",
            q33: "NOT GIVEN",
            q34: "FALSE",
            q35: "TRUE",
            q36: "TRUE",
            q37: "outer shells",
            q38: "chocolate liquor",
            q39: "cocoa butter",
            q40: "moulds"
        };

        let lastSelection = null;
        let highlightTarget = null;
        let currentPanel = null;
        let submitted = false;
        let currentQuestion = 27;
        let isResizing = false;
        let seconds = 20 * 60; // 20 minutes
        let timerInterval;

        const highlightBtn = document.getElementById('highlight-btn');
        const removeHighlightBtn = document.getElementById('remove-highlight-btn');
        const passagePanel = document.querySelector('.passage-container');
        const questionsPanel = document.getElementById('questions');
        const resizer = document.getElementById('resizer');
        const submitBtn = document.getElementById('submit-btn');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const resultsModal = document.getElementById('results-modal');
        const scoreDisplay = document.getElementById('score-display');
        const closeModalBtn = document.getElementById('close-modal');
        const reviewBtn = document.getElementById('review-answers');
        const timerElement = document.querySelector('.timer span');
        const timerContainer = document.querySelector('.timer');

        // Timer
        function updateTimer() {
            seconds--;
            const minutes = Math.floor(seconds / 60);
            const secs = seconds % 60;
            timerElement.textContent = `${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            if (seconds <= 2 * 60) {
                timerContainer.classList.add('warning');
            }
            if (seconds <= 0) {
                clearInterval(timerInterval);
                if (!submitted) {
                    alert('Time is up! Submitting test.');
                    submitTest();
                }
            }
        }

        // Highlight functionality
        function getValidSelection() {
            const sel = window.getSelection();
            if (!sel.rangeCount || sel.isCollapsed) return null;
            const range = sel.getRangeAt(0);
            if (passagePanel.contains(range.commonAncestorContainer)) {
                currentPanel = passagePanel;
            } else if (questionsPanel.contains(range.commonAncestorContainer)) {
                currentPanel = questionsPanel;
            } else {
                return null;
            }
            return range;
        }

        function showHighlightBtn(range) {
            const rect = range.getBoundingClientRect();
            highlightBtn.style.top = `${window.scrollY + rect.top - 35}px`;
            highlightBtn.style.left = `${window.scrollX + rect.left}px`;
            highlightBtn.style.display = 'block';
        }

        function hideHighlightBtn() {
            highlightBtn.style.display = 'none';
        }

        function showRemoveBtn(span) {
            const rect = span.getBoundingClientRect();
            removeHighlightBtn.style.top = `${window.scrollY + rect.top - 35}px`;
            removeHighlightBtn.style.left = `${window.scrollX + rect.left}px`;
            removeHighlightBtn.style.display = 'block';
            highlightTarget = span;
        }

        function hideRemoveBtn() {
            removeHighlightBtn.style.display = 'none';
            highlightTarget = null;
        }

        highlightBtn.addEventListener('click', () => {
            if (lastSelection) {
                const span = document.createElement('span');
                span.className = 'highlight';
                span.appendChild(lastSelection.extractContents());
                lastSelection.insertNode(span);
                window.getSelection().removeAllRanges();
                hideHighlightBtn();
            }
        });

        removeHighlightBtn.addEventListener('click', () => {
            if (highlightTarget) {
                const parent = highlightTarget.parentNode;
                while (highlightTarget.firstChild) {
                    parent.insertBefore(highlightTarget.firstChild, highlightTarget);
                }
                parent.removeChild(highlightTarget);
                hideRemoveBtn();
            }
        });

        document.addEventListener('selectionchange', () => {
            hideHighlightBtn();
            hideRemoveBtn();
            const range = getValidSelection();
            if (range) {
                lastSelection = range;
                showHighlightBtn(range);
            } else {
                lastSelection = null;
            }
        });

        [passagePanel, questionsPanel].forEach(panel => {
            panel.addEventListener('scroll', () => {
                hideHighlightBtn();
                hideRemoveBtn();
            });
        });

        document.addEventListener('mousedown', (e) => {
            if (e.target !== highlightBtn && e.target !== removeHighlightBtn) {
                hideHighlightBtn();
                hideRemoveBtn();
            }
        });

        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('highlight')) {
                e.preventDefault();
                showRemoveBtn(e.target);
            }
        });

        // Resizer
        resizer.addEventListener('mousedown', (e) => {
            isResizing = true;
            document.body.style.cursor = 'col-resize';
            document.body.style.userSelect = 'none';
        });

        document.addEventListener('mousemove', (e) => {
            if (!isResizing) return;
            const container = document.querySelector('.main-content');
            const containerRect = container.getBoundingClientRect();
            const mouseX = e.clientX - containerRect.left;
            const containerWidth = containerRect.width;
            const leftPercentage = (mouseX / containerWidth) * 100;
            const rightPercentage = 100 - leftPercentage;
            if (leftPercentage >= 30 && leftPercentage <= 70) {
                document.querySelector('.passage-container').style.flex = `${leftPercentage}%`;
                document.querySelector('.questions-container').style.width = `${rightPercentage}%`;
            }
        });

        document.addEventListener('mouseup', () => {
            if (isResizing) {
                isResizing = false;
                document.body.style.cursor = '';
                document.body.style.userSelect = '';
            }
        });

        // Navigation
        function scrollToQuestion(num) {
            const el = document.querySelector(`[data-question="${num}"]`) || document.querySelector(`input[name="q${num}"]`);
            if (el) el.scrollIntoView({ behavior: 'smooth', block: 'center' });
            updateCurrentQuestion(num);
        }

        function updateCurrentQuestion(num) {
            currentQuestion = num;
            document.querySelectorAll('.progress-item').forEach(item => {
                item.classList.remove('current');
                if (item.dataset.question == num) {
                    item.classList.add('current');
                }
            });
            prevBtn.disabled = num <= 27;
            nextBtn.disabled = num >= 40;
        }

        document.querySelectorAll('.progress-item').forEach(item => {
            item.addEventListener('click', () => {
                const qNum = parseInt(item.dataset.question);
                scrollToQuestion(qNum);
            });
        });

        prevBtn.addEventListener('click', () => {
            if (currentQuestion > 27) scrollToQuestion(currentQuestion - 1);
        });

        nextBtn.addEventListener('click', () => {
            if (currentQuestion < 40) scrollToQuestion(currentQuestion + 1);
        });

        // Mark questions as answered
        document.querySelectorAll('input[type="radio"], input[type="text"]').forEach(input => {
            input.addEventListener('change', () => {
                if (submitted) return;
                const qNumMatch = input.name.match(/^q(\d+)$/);
                if (qNumMatch) {
                    const qNum = parseInt(qNumMatch[1]);
                    const item = document.querySelector(`.progress-item[data-question="${qNum}"]`);
                    if (item && !item.classList.contains('answered')) {
                        const value = input.type === 'radio' ? input.value : input.value.trim();
                        if (value) {
                            item.classList.add('answered');
                        }
                    }
                }
            });
        });

        submitBtn.addEventListener('click', submitTest);

        function submitTest() {
            if (submitted) return;
            if (!confirm('Are you sure you want to submit?')) return;
            submitted = true;
            clearInterval(timerInterval);
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<i class="fas fa-check"></i> Submitted';
            let score = 0;
            const results = {};

            // Process questions 27-40
            for (let i = 27; i <= 40; i++) {
                const key = `q${i}`;
                let userAnswer = '';
                let isCorrect = false;
                if (i <= 36) {
                    // Radio button questions (27-36)
                    const checkedRadio = document.querySelector(`input[name="${key}"]:checked`);
                    if (checkedRadio) {
                        userAnswer = checkedRadio.value;
                        isCorrect = userAnswer === correctAnswers[key];
                        document.querySelectorAll(`input[name="${key}"]`).forEach(radio => {
                            radio.disabled = true;
                        });
                    }
                } else {
                    // Text input questions (37-40)
                    const inputEl = document.querySelector(`input[name="${key}"]`);
                    if (inputEl && inputEl.value.trim() !== '') {
                        userAnswer = inputEl.value.trim().toLowerCase();
                        isCorrect = userAnswer === correctAnswers[key].toLowerCase();
                        inputEl.disabled = true;
                    }
                }
                if (isCorrect) score++;
                results[key] = { userAnswer, correct: correctAnswers[key], isCorrect };
            }

            scoreDisplay.textContent = `${score}/14`;
            for (let i = 27; i <= 40; i++) {
                const item = document.querySelector(`.progress-item[data-question="${i}"]`);
                const res = results[`q${i}`];
                if (item && res) {
                    item.classList.remove('current', 'answered');
                    item.classList.add(res.isCorrect ? 'correct' : 'incorrect');
                }
            }
            window.testResults = results;
            resultsModal.style.display = 'flex';
        }

        function showCorrectAnswers() {
            if (!submitted) return;
            document.querySelectorAll('.answer-indicator').forEach(el => el.remove());

            // Process questions 27-40
            for (let i = 27; i <= 40; i++) {
                const key = `q${i}`;
                const res = window.testResults[key];
                if (!res) continue;
                const targetElement = (i <= 36) ?
                    document.querySelector(`[data-question="${i}"] .options`) :
                    document.querySelector(`input[name="${key}"]`).parentNode;
                if (!targetElement) continue;
                const div = document.createElement('div');
                div.className = 'answer-indicator';
                div.classList.add(res.isCorrect ? 'correct' : 'incorrect');
                if (i >= 37) div.style.display = 'inline-block';
                if (res.isCorrect) {
                    div.innerHTML = `<i class="fas fa-check"></i> Correct! You chose: <strong>${res.userAnswer || 'No answer'}</strong>`;
                } else {
                    const userDisplay = res.userAnswer || 'No answer';
                    div.innerHTML = `<i class="fas fa-times"></i> Incorrect. You chose: <strong>${userDisplay}</strong><br><strong>Correct:</strong> ${res.correct}`;
                }
                targetElement.appendChild(div);
            }
        }

        closeModalBtn.addEventListener('click', () => {
            resultsModal.style.display = 'none';
        });

        reviewBtn.addEventListener('click', () => {
            resultsModal.style.display = 'none';
            showCorrectAnswers();
            scrollToQuestion(27);
        });

        function startTest() {
            document.getElementById('startScreen').classList.add('hidden');
            document.getElementById('loadingScreen').classList.add('hidden');
            document.getElementById('testContainer').classList.remove('hidden');
            timerInterval = setInterval(updateTimer, 1000);
            scrollToQuestion(27);
        }

        // Initialize on page load
        window.addEventListener('load', () => {
            setTimeout(() => {
                document.getElementById('loadingScreen').classList.add('hidden');
                document.getElementById('startScreen').classList.remove('hidden');
            }, 3000);
        });
    </script>
</body>

</html>