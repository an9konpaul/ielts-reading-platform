<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
            overflow: hidden;
        }

        .loading-screen {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #f9fafb;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 9999;
        }

        .loading-content {
            text-align: center;
        }

        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: #2563eb;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .loading-title {
            font-size: 1.2rem;
            color: #6b7280;
            margin-bottom: 20px;
        }

        .loading-subtitle {
            font-size: 1rem;
            color: #9ca3af;
        }

        .start-screen {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #f9fafb;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 9998;
        }

        .start-content {
            text-align: center;
        }

        .start-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #111827;
            margin-bottom: 24px;
        }

        .start-subtitle {
            color: #6b7280;
            margin-bottom: 24px;
        }

        .start-button {
            padding: 12px 32px;
            background-color: #2563eb;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .start-button:hover {
            background-color: #1d4ed8;
        }

        .hidden {
            display: none !important;
        }

        .container {
            display: flex;
            flex-direction: column;
            height: 100vh;
            width: 100vw;
            background: white;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        header {
            background-color: #ffffff;
            color: #333;
            padding: 8px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 100;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            flex-shrink: 0;
            border-bottom: 1px solid #e2e8f0;
        }

        .passage-info {
            font-size: 0.9rem;
            font-weight: 500;
            color: #2d3748;
        }

        .timer {
            background-color: rgba(255, 193, 193, 0.5);
            padding: 6px 12px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.3s;
            min-width: 80px;
            text-align: center;
            font-size: 0.9rem;
            color: #c53030;
            border: 1px solid rgba(255, 120, 120, 0.3);
        }

        .timer.warning {
            color: #9b2c2c;
            background-color: rgba(254, 178, 178, 0.7);
            border-color: rgba(245, 101, 101, 0.5);
        }

        .logo-area {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background-color: #007bff;
            color: white;
            text-decoration: none;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0, 123, 255, 0.3);
            cursor: pointer;
        }

        .logo-area:hover {
            background-color: #0056b3;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 123, 255, 0.4);
        }

        .logo-area i {
            font-size: 1.1rem;
        }

        .progress-container {
            background-color: #f8f9fa;
            padding: 4px 20px;
            z-index: 100;
            flex-shrink: 0;
            border-top: 1px solid #e2e8f0;
        }

        .progress-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 5px;
        }

        .progress-items {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }

        .nav-buttons {
            display: flex;
            gap: 6px;
        }

        .progress-item {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #4a5568;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.95rem;
            border: 1px solid #cbd5e0;
        }

        .progress-item.current {
            background-color: #4299e1;
            color: white;
            transform: scale(1.1);
            border-color: #2b6cb0;
        }

        .progress-item.answered {
            background-color: #9ae6b4;
            color: #22543d;
            border-color: #68d391;
        }

        .progress-item.correct {
            background-color: #48bb78;
            color: white;
            border-color: #38a169;
        }

        .progress-item.incorrect {
            background-color: #fed7d7;
            color: #c53030;
            border-color: #feb2b2;
        }

        .progress-item:hover {
            background-color: #cbd5e0;
            transform: scale(1.05);
        }

        .btn {
            padding: 6px 14px;
            border: 1px solid #cbd5e0;
            border-radius: 4px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.95rem;
            background-color: #f7fafc;
            color: #4a5568;
        }

        .btn i {
            font-size: 1rem;
        }

        .btn:hover {
            background-color: #edf2f7;
            border-color: #a0aec0;
        }

        .btn-primary {
            background-color: #f7fafc;
            color: #4a5568;
            border: 1px solid #cbd5e0;
        }

        .btn-primary:hover {
            background-color: #edf2f7;
            border-color: #a0aec0;
        }

        .btn-secondary {
            background-color: #f7fafc;
            color: #4a5568;
            border: 1px solid #cbd5e0;
        }

        .btn-secondary:hover {
            background-color: #edf2f7;
            border-color: #a0aec0;
        }

        .btn-submit {
            background-color: #48bb78;
            color: white;
            font-weight: 900;
            border: 1px solid #38a169;
        }

        .btn-submit:hover {
            background-color: #38a169;
            border-color: #2f855a;
        }

        .btn-submit:disabled {
            background-color: #9ae6b4;
            color: #718096;
            cursor: not-allowed;
            border: 1px solid #68d391;
        }

        .main-content {
            display: flex;
            flex: 1;
            overflow: hidden;
            position: relative;
        }

        .passage-container {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background-color: #fafafa;
            position: relative;
        }

        .resizer {
            width: 4px;
            background-color: #cbd5e0;
            cursor: col-resize;
            position: relative;
            transition: background-color 0.2s;
        }

        .resizer:hover {
            background-color: #a0aec0;
        }

        .resizer::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 30px;
            height: 60px;
            background-color: rgba(203, 213, 224, 0.5);
            border-radius: 4px;
            pointer-events: none;
        }

        .questions-container {
            width: 40%;
            padding: 20px;
            overflow-y: auto;
            background-color: white;
            border-left: 1px solid #e2e8f0;
        }

        .passage {
            max-width: 800px;
            margin: 0 auto;
        }

        .passage h2 {
            color: #2d3748;
            margin-bottom: 20px;
            font-size: 1.4rem;
        }

        .passage-content p {
            margin-top: 15px;
            margin-bottom: 20px;
            text-align: justify;
        }

        .passage h2 {
            color: #2d3748;
            margin-bottom: 20px;
            font-size: 1.4rem;
        }

        .passage p {
            margin-top: 20px;
            margin-bottom: 25px;
            text-align: justify;
        }

        .question-section {
            max-width: 800px;
            margin: 0 auto;
        }

        .section-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 20px;
            padding-bottom: 8px;
            border-bottom: 2px solid #e2e8f0;
        }

        .question {
            margin-bottom: 25px;
            padding: 15px;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            background-color: #ffffff;
            transition: box-shadow 0.2s;
        }

        .question:hover {
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .question-text {
            font-weight: 500;
            margin-bottom: 12px;
            color: #2d3748;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .option {
            display: flex;
            align-items: center;
            padding: 8px 12px;
            border: 1px solid #e2e8f0;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.9rem;
        }

        .option:hover {
            background-color: #f7fafc;
            border-color: #cbd5e0;
        }

        .option input {
            margin-right: 2px;
            width: 16px;
            height: 16px;
        }

        .input-field {
            padding: 8px 10px;
            border: 1px solid #e2e8f0;
            border-radius: 4px;
            width: 20%;
            margin-top: 5px;
            font-size: 0.9rem;
        }

        .input-field:focus {
            border-color: #4299e1;
            outline: none;
            box-shadow: 0 0 0 2px rgba(66, 153, 225, 0.2);
        }

        select.input-field {
            padding: 8px 10px;
            border: 1px solid #e2e8f0;
            border-radius: 4px;
            width: 20%;
            margin-top: 5px;
            font-size: 0.9rem;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            font-size: 0.9rem;
        }

        th,
        td {
            border: 1px solid #e2e8f0;
            padding: 10px;
            text-align: left;
        }

        th {
            background-color: #f1f5f9;
            font-weight: 600;
            color: #2d3748;
        }

        .answer-indicator {
            background-color: #e6fffa;
            border: 1px solid #38b2ac;
            padding: 10px;
            border-radius: 4px;
            margin-top: 10px;
            font-size: 0.9rem;
        }

        .answer-indicator.correct {
            background-color: #e6fffa;
            border-color: #38b2ac;
            color: #234e52;
        }

        .answer-indicator.incorrect {
            background-color: #fed7d7;
            border-color: #fc8181;
            color: #742a2a;
        }

        .question-group {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .question-group-title {
            font-weight: 600;
            margin-bottom: 12px;
            color: #2d3748;
            font-size: 1rem;
        }

        .highlight {
            background-color: #ffff00;
            cursor: pointer;
        }

        #highlight-btn,
        #remove-highlight-btn {
            position: absolute;
            z-index: 9999;
            display: none;
            padding: 6px 12px;
            font-size: 14px;
            border: 1px solid #888;
            border-radius: 4px;
            cursor: pointer;
            background-color: white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            width: 90%;
            max-width: 450px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .score-display {
            font-size: 2.2rem;
            font-weight: bold;
            margin: 20px 0;
            color: #2d3748;
        }

        .score-breakdown {
            margin: 20px 0;
            text-align: left;
        }

        .score-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #e2e8f0;
            font-size: 0.95rem;
        }

        .modal-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
        }

        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }

            .questions-container {
                width: 100%;
                border-left: none;
                border-top: 1px solid #e2e8f0;
            }

            .resizer {
                width: 100%;
                height: 4px;
                cursor: row-resize;
            }

            .resizer::before {
                width: 60px;
                height: 30px;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
            }

            .progress-item {
                width: 32px;
                height: 32px;
                font-size: 0.85rem;
            }

            .passage-info {
                font-size: 0.9rem;
            }

            header {
                flex-direction: column;
                gap: 10px;
                padding: 10px;
            }

            .logo-area {
                order: 1;
            }

            .passage-info {
                order: 2;
            }

            .timer {
                order: 3;
            }
        }

        @media (max-width: 480px) {
            .progress-item {
                width: 32px;
                height: 32px;
                font-size: 0.85rem;
            }

            .passage-info {
                font-size: 0.9rem;
            }
        }
    </style>
</head>



<body>
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-content">
            <div class="spinner"></div>
            <h2 class="loading-title">Your test will begin shortly</h2>
            <p class="loading-subtitle">Please wait</p>
        </div>
    </div>

    <!-- Start Screen -->
    <div id="startScreen" class="start-screen hidden">
        <div class="start-content">
            <h1 class="start-title">IELTSwithJurabek</h1>
            <p class="start-subtitle">Ready to begin your reading test?</p>
            <button class="start-button" onclick="startTest()">Start Test</button>
        </div>
    </div>

    <!-- Test Container -->
    <div class="container hidden" id="testContainer">
        <header>
            <div class="passage-info">IELTSwithJurabek</div>
            <div class="timer">
                <i class="fas fa-clock"></i>
                <span>20:00</span>
            </div>
            <div class="logo-area" onclick="window.open('https://t.me/IELTSwithJurabek', '_blank')">
                <i class="fas fa-paper-plane"></i>
                <span>Click for more TESTS</span>
            </div>
        </header>

        <button id="highlight-btn" type="button">Highlight</button>
        <button id="remove-highlight-btn" type="button">Remove Highlight</button>

        <div class="main-content">
            <!-- Reading Passage -->
            <div class="passage-container" role="region" aria-label="Reading Passage">
                <h2 class="section-title">READING PASSAGE 3</h2>
                <div class="passage-content" id="passage">
                    <h3>Crossing the Threshold</h3>
                    <p>The renovated Auckland Art Gallery in New Zealand unites old and new, creating an irresistible
                        urge to step inside.</p>
                    <p><strong>A</strong> Architects are finding it very difficult in today's cultural landscape. The
                        profession faces a three-way threat: a public that apparently doesn't understand what architects
                        do, developers who couldn't care less what they do, and overbearing councils micromanaging every
                        single aspect of what they do. According to sources within the architectural profession, the
                        situation is much worse when architects work on municipal buildings, as architects FIMT and
                        Archimedia discovered with their Auckland Gallery makeover, where a vast number of external
                        pressures threatened the project, and with so many bureaucratic difficulties it looked doomed to
                        fail.</p>
                    <p><strong>B</strong> The major challenge of the gallery renovation project was that it involved two
                        parts. The first was to restore the heritage building, dating back to 1888, which contained a
                        network of small spaces, refurbished so often it contained 17 different floor heights. The
                        second was to deliver a new extension that would not only double floor and exhibition space but
                        also attract new patrons, a total necessity. While the old building's circulation was
                        off-putting, so was something intangible yet just as powerful: its atmosphere. For many,
                        Auckland Art Gallery was just an old building that served a limited range of patrons with
                        highbrow interests, missing its chance to engage with new audiences.</p>
                    <p><strong>C</strong> A 2003 survey of young people's impressions of the gallery confirmed this
                        opinion, sounding more like references to an abandoned building. For the survey authors,
                        "threshold fear"—where certain groups are intimidated from entering certain spaces by their
                        off-putting atmosphere—was the institution's undoing, something no architect wants anything to
                        do with. For those young people, Auckland Art Gallery was "undemocratic, dusty" and "cold—the
                        epitome of threshold fear." Also, 16% of the sample group had no idea where it even was, despite
                        being interviewed on the pavement right outside it. Clearly, the gallery was fatally out of step
                        at a time when New Zealand's national museum in Wellington was successfully engaging broader
                        audiences with contemporary branding and marketing, interactive displays, and temporary events.
                    </p>
                    <p><strong>D</strong> The decision to evolve the gallery was actually made in 2000, although it took
                        eight years for building to commence, as the architects fought off heritage committees and
                        conservationists trying to stop them. The architects were not just dealing with a disillusioned
                        public, but also with precious timber and the parkland which surrounds the building. Pushing the
                        design through the Environment Court, the body which approves renovations of this scale, alone
                        took three years. During this time, the budget blew out by several million dollars, the funding
                        dried up, and the new wing had to be completely redesigned. Even after the redesigns, the use of
                        kauri timber, with its significance to New Zealand's Maori people, stirred up political debate.
                        In the new building, the architects have used kauri to produce a canopy with a curving interior
                        roof supported by tapered steel columns, also clad in kauri. The canopy represents a signature
                        public face, its curvature filtering light to the forecourt to the west and creating a visual
                        echo of the canopy of pohutukawa trees in Albert Park to the east. The park also has cultural
                        significance to Maori as it was the site of early settlements.</p>
                    <p><strong>E</strong> Another success is the refurbishment of the heritage building, especially the
                        Mackelvie Gallery, in disrepair after its characteristic early twentieth-century Edwardian
                        decoration had been stripped out or walled away in previous renovations. Remarkably, the
                        Mackelvie space has been reconstructed from two old photos, although the problem of multiple
                        floor levels was so serious that scaffolding had to be erected at the highest level, with work
                        progressing downwards—the reverse of normal practice. When it was over, a fascinating detail was
                        retained: the lowest level visible under glass embedded in the new floor, the building itself as
                        artwork, while elsewhere columns from the old gallery have been exposed in the walls of the new
                        wing.</p>
                    <p><strong>F</strong> The connection is reinforced by sculptures from Maori artist Arnold Wilson
                        decorating the columns, while fellow artist Bernard Makoare was a consultant, ensuring the
                        gallery emphasized Maori beliefs. Still, that didn't stop the conservationist Stephen King from
                        accusing the architects of 'throwing' kauri at a 'mediocre building' and of misappropriating the
                        'mana' (spiritual energy) of the precious material (which is almost extinct: harvesting of both
                        petrified and swamp kauri has been likened to a gold rush). However, the kauri that was used
                        here was from the forest floor, and King's misconceptions sum up the prejudice that surrounded
                        the project.</p>
                    <p><strong>G</strong> Objections also came from the Auckland Regional Council, worrying about the
                        extension's impact on Albert Park, yet the project's relationship with parkland is one of the
                        most successful outcomes. Impact is not only minimal, but it improves the park's social
                        function. The extension's enormous glass atrium opens up the building by directing the gaze from
                        street level to the parkland beyond, while inside, the new art space is fronted along the east
                        by a continuous glass wall incorporating the park into the gallery. The glass becomes a "screen"
                        for viewing the outside world and makes the art accessible to those in the park, a far cry from
                        both "white cube" galleries worldwide, the plain boxes where paintings are hung in antiseptic
                        walls, and also the dusty, impermeable Auckland Gallery of old.</p>
                    <p><strong>H</strong> In 2008, the gallery averaged just 190,000 visitors annually. After reopening,
                        it had 300,000 in five months. Cynics will chalk that up to the novelty of the new, but the fact
                        is the gallery is now an alluring cultural space which is crawling with young people.</p>
                </div>
            </div>

            <div class="resizer" id="resizer"></div>

            <!-- Questions -->
            <div class="questions-container" id="questions" role="region" aria-label="Questions">
                <h2 class="section-title">Questions 27-40</h2>
                <p>You should spend about 20 minutes on Questions 27–40, which are based on Reading Passage 3.</p>

                <div class="question-group">
                    <div class="question-group-title">Questions 27-31</div>
                    <p>Choose the correct letter, A, B, C, or D.<br>
                        Write the correct letter in boxes 27–31 on your answer sheet.</p>

                    <div class="question" data-question="27">
                        <div class="question-text">27. What is the writer's main point in the first paragraph?</div>
                        <div class="options">
                            <label class="option"><input type="radio" name="q27" value="A">A. Criticism of architects by
                                different groups is unfair.</label>
                            <label class="option"><input type="radio" name="q27" value="B">B. The architectural
                                profession is generally well respected.</label>
                            <label class="option"><input type="radio" name="q27" value="C">C. The most difficult
                                projects for architects are public buildings.</label>
                            <label class="option"><input type="radio" name="q27" value="D">D. Failure to deliver
                                buildings is a result of poor communication.</label>
                        </div>
                    </div>

                    <div class="question" data-question="28">
                        <div class="question-text">28. The Auckland Gallery project was particularly difficult because
                        </div>
                        <div class="options">
                            <label class="option"><input type="radio" name="q28" value="A">A. the existing building was
                                old and parts of it had fallen down.</label>
                            <label class="option"><input type="radio" name="q28" value="B">B. there was a high number of
                                floors in the building.</label>
                            <label class="option"><input type="radio" name="q28" value="C">C. it involved renovating the
                                existing building and adding a new one.</label>
                            <label class="option"><input type="radio" name="q28" value="D">D. it needed to satisfy the
                                requirements of the existing patrons.</label>
                        </div>
                    </div>

                    <div class="question" data-question="29">
                        <div class="question-text">29. What disturbing information did the architects find out from the
                            survey of young people?</div>
                        <div class="options">
                            <label class="option"><input type="radio" name="q29" value="A">A. They did not visit the
                                gallery because of the way it made them feel.</label>
                            <label class="option"><input type="radio" name="q29" value="B">B. They thought that the
                                gallery buildings were not in use.</label>
                            <label class="option"><input type="radio" name="q29" value="C">C. The gallery had the
                                reputation of being dirty.</label>
                            <label class="option"><input type="radio" name="q29" value="D">D. They did not like the
                                entrance.</label>
                        </div>
                    </div>

                    <div class="question" data-question="30">
                        <div class="question-text">30. What point is the writer making when he says that 16% of the
                            sample group did not know where the museum was?</div>
                        <div class="options">
                            <label class="option"><input type="radio" name="q30" value="A">A. Young people are not
                                interested in galleries.</label>
                            <label class="option"><input type="radio" name="q30" value="B">B. The gallery was not
                                reaching out to involve young people.</label>
                            <label class="option"><input type="radio" name="q30" value="C">C. The entrance to the
                                gallery was not well signposted.</label>
                            <label class="option"><input type="radio" name="q30" value="D">D. The location of the
                                gallery was difficult to access.</label>
                        </div>
                    </div>

                    <div class="question" data-question="31">
                        <div class="question-text">31. Maori artists were used on this project to</div>
                        <div class="options">
                            <label class="option"><input type="radio" name="q31" value="A">A. satisfy the concerns of
                                conservationists.</label>
                            <label class="option"><input type="radio" name="q31" value="B">B. protect sacred materials
                                in the Albert Park site.</label>
                            <label class="option"><input type="radio" name="q31" value="C">C. make sure the gallery
                                respects Maori culture.</label>
                            <label class="option"><input type="radio" name="q31" value="D">D. ensure that certain
                                sources of kauri were not used.</label>
                        </div>
                    </div>
                </div>

                <div class="question-group">
                    <div class="question-group-title">Questions 32-36</div>
                    <p>Do the following statements agree with the claims of the writer in Reading Passage 3?<br>
                        In boxes 32–36 on your answer sheet, write<br>
                        <strong>YES</strong> if the statement agrees with the claims of the writer<br>
                        <strong>NO</strong> if the statement contradicts the claims of the writer<br>
                        <strong>NOT GIVEN</strong> if it is impossible to say what the writer thinks about this
                    </p>

                    <div class="question" data-question="32">
                        <div class="question-text">32. Before the renovation, the Auckland Art Gallery was regarded as
                            an elitist institution.</div>
                        <div class="options">
                            <label class="option"><input type="radio" name="q32" value="YES">YES</label>
                            <label class="option"><input type="radio" name="q32" value="NO">NO</label>
                            <label class="option"><input type="radio" name="q32" value="NOT GIVEN">NOT GIVEN</label>
                        </div>
                    </div>

                    <div class="question" data-question="33">
                        <div class="question-text">33. Stephen King's intervention in the project shows his
                            understanding of the architects' use of kauri.</div>
                        <div class="options">
                            <label class="option"><input type="radio" name="q33" value="YES">YES</label>
                            <label class="option"><input type="radio" name="q33" value="NO">NO</label>
                            <label class="option"><input type="radio" name="q33" value="NOT GIVEN">NOT GIVEN</label>
                        </div>
                    </div>

                    <div class="question" data-question="34">
                        <div class="question-text">34. The way the building interacts with its surroundings is a
                            triumph.</div>
                        <div class="options">
                            <label class="option"><input type="radio" name="q34" value="YES">YES</label>
                            <label class="option"><input type="radio" name="q34" value="NO">NO</label>
                            <label class="option"><input type="radio" name="q34" value="NOT GIVEN">NOT GIVEN</label>
                        </div>
                    </div>

                    <div class="question" data-question="35">
                        <div class="question-text">35. The glass flooring in the Mackelvie Gallery which reveals old
                            features.</div>
                        <div class="options">
                            <label class="option"><input type="radio" name="q35" value="YES">YES</label>
                            <label class="option"><input type="radio" name="q35" value="NO">NO</label>
                            <label class="option"><input type="radio" name="q35" value="NOT GIVEN">NOT GIVEN</label>
                        </div>
                    </div>

                    <div class="question" data-question="36">
                        <div class="question-text">36. The design of the extension to the Auckland Art Gallery is
                            similar to the design of white cube galleries in other parts of the world.</div>
                        <div class="options">
                            <label class="option"><input type="radio" name="q36" value="YES">YES</label>
                            <label class="option"><input type="radio" name="q36" value="NO">NO</label>
                            <label class="option"><input type="radio" name="q36" value="NOT GIVEN">NOT GIVEN</label>
                        </div>
                    </div>
                </div>

                <div class="question-group">
                    <div class="question-group-title">Questions 37-40</div>
                    <p>Complete each sentence with the correct ending, A–F, below.<br>
                        Write the correct letter, A–F, in boxes 37–40 on your answer sheet.</p>

                    <div class="question" data-question="37">
                        <div class="question-text">37. The destruction of Edwardian ornamentation</div>
                        <div class="options">
                            <label class="option"><input type="radio" name="q37" value="A">A. resulted in work being
                                done in the opposite direction to that usually followed.</label>
                            <label class="option"><input type="radio" name="q37" value="B">B. is more than cosmetic and
                                has improved the circulation.</label>
                            <label class="option"><input type="radio" name="q37" value="C">C. was the clue to rebuilding
                                the Mackelvie Gallery successfully.</label>
                            <label class="option"><input type="radio" name="q37" value="D">D. has resulted in the
                                building itself becoming a work of art.</label>
                            <label class="option"><input type="radio" name="q37" value="E">E. means that you should be
                                able to tell whether you are in the old wing or the new one.</label>
                            <label class="option"><input type="radio" name="q37" value="F">F. was the result of earlier
                                attempts to modernise the building.</label>
                        </div>
                    </div>

                    <div class="question" data-question="38">
                        <div class="question-text">38. It is extraordinary that a limited number of photographs</div>
                        <div class="options">
                            <label class="option"><input type="radio" name="q38" value="A">A. resulted in work being
                                done in the opposite direction to that usually followed.</label>
                            <label class="option"><input type="radio" name="q38" value="B">B. is more than cosmetic and
                                has improved the circulation.</label>
                            <label class="option"><input type="radio" name="q38" value="C">C. was the clue to rebuilding
                                the Mackelvie Gallery successfully.</label>
                            <label class="option"><input type="radio" name="q38" value="D">D. has resulted in the
                                building itself becoming a work of art.</label>
                            <label class="option"><input type="radio" name="q38" value="E">E. means that you should be
                                able to tell whether you are in the old wing or the new one.</label>
                            <label class="option"><input type="radio" name="q38" value="F">F. was the result of earlier
                                attempts to modernise the building.</label>
                        </div>
                    </div>

                    <div class="question" data-question="39">
                        <div class="question-text">39. The problem of having so many floor levels to deal with</div>
                        <div class="options">
                            <label class="option"><input type="radio" name="q39" value="A">A. resulted in work being
                                done in the opposite direction to that usually followed.</label>
                            <label class="option"><input type="radio" name="q39" value="B">B. is more than cosmetic and
                                has improved the circulation.</label>
                            <label class="option"><input type="radio" name="q39" value="C">C. was the clue to rebuilding
                                the Mackelvie Gallery successfully.</label>
                            <label class="option"><input type="radio" name="q39" value="D">D. has resulted in the
                                building itself becoming a work of art.</label>
                            <label class="option"><input type="radio" name="q39" value="E">E. means that you should be
                                able to tell whether you are in the old wing or the new one.</label>
                            <label class="option"><input type="radio" name="q39" value="F">F. was the result of earlier
                                attempts to modernise the building.</label>
                        </div>
                    </div>

                    <div class="question" data-question="40">
                        <div class="question-text">40. The glass flooring in the Mackelvie Gallery which reveals old
                            features</div>
                        <div class="options">
                            <label class="option"><input type="radio" name="q40" value="A">A. resulted in work being
                                done in the opposite direction to that usually followed.</label>
                            <label class="option"><input type="radio" name="q40" value="B">B. is more than cosmetic and
                                has improved the circulation.</label>
                            <label class="option"><input type="radio" name="q40" value="C">C. was the clue to rebuilding
                                the Mackelvie Gallery successfully.</label>
                            <label class="option"><input type="radio" name="q40" value="D">D. has resulted in the
                                building itself becoming a work of art.</label>
                            <label class="option"><input type="radio" name="q40" value="E">E. means that you should be
                                able to tell whether you are in the old wing or the new one.</label>
                            <label class="option"><input type="radio" name="q40" value="F">F. was the result of earlier
                                attempts to modernise the building.</label>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="progress-container">
            <div class="progress-nav">
                <div class="progress-items">
                    <div class="progress-item current" data-question="27">27</div>
                    <div class="progress-item" data-question="28">28</div>
                    <div class="progress-item" data-question="29">29</div>
                    <div class="progress-item" data-question="30">30</div>
                    <div class="progress-item" data-question="31">31</div>
                    <div class="progress-item" data-question="32">32</div>
                    <div class="progress-item" data-question="33">33</div>
                    <div class="progress-item" data-question="34">34</div>
                    <div class="progress-item" data-question="35">35</div>
                    <div class="progress-item" data-question="36">36</div>
                    <div class="progress-item" data-question="37">37</div>
                    <div class="progress-item" data-question="38">38</div>
                    <div class="progress-item" data-question="39">39</div>
                    <div class="progress-item" data-question="40">40</div>
                </div>
                <div class="nav-buttons">
                    <button class="btn btn-secondary" id="prev-btn" disabled><i class="fas fa-arrow-left"></i>
                        Previous</button>
                    <button class="btn btn-secondary" id="next-btn">Next <i class="fas fa-arrow-right"></i></button>
                    <button class="btn btn-submit" id="submit-btn">Submit Test <i
                            class="fas fa-paper-plane"></i></button>
                </div>
            </div>
        </div>
    </div>

    <!-- Results Modal -->
    <div class="modal" id="results-modal">
        <div class="modal-content">
            <h2>Test Results</h2>
            <div class="score-display" id="score-display">0/14</div>
            <div class="score-breakdown">
                <div class="score-item">
                    <span>Passage 3:</span>
                    <span id="passage3-score">0/14</span>
                </div>
            </div>
            <div class="modal-buttons">
                <button class="btn btn-secondary" id="close-modal">Close</button>
                <button class="btn btn-primary" id="review-answers">Review Answers</button>
            </div>
        </div>
    </div>

    <script>
        // Correct Answers for Questions 27-40
        const correctAnswers = {
            q27: "C",
            q28: "D",
            q29: "A",
            q30: "B",
            q31: "C",
            q32: "NO",
            q33: "NO",
            q34: "YES",
            q35: "NOT GIVEN",
            q36: "NO",
            q37: "F",
            q38: "C",
            q39: "A",
            q40: "E"
        };
        let lastSelection = null;
        let highlightTarget = null;
        let currentPanel = null;
        let submitted = false;
        let currentQuestion = 27;
        let isResizing = false;
        let seconds = 20 * 60; // 20 minutes
        let timerInterval;
        const highlightBtn = document.getElementById('highlight-btn');
        const removeHighlightBtn = document.getElementById('remove-highlight-btn');
        const passagePanel = document.getElementById('passage');
        const questionsPanel = document.getElementById('questions');
        const resizer = document.getElementById('resizer');
        const submitBtn = document.getElementById('submit-btn');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const resultsModal = document.getElementById('results-modal');
        const scoreDisplay = document.getElementById('score-display');
        const passage3Score = document.getElementById('passage3-score');
        const closeModalBtn = document.getElementById('close-modal');
        const reviewBtn = document.getElementById('review-answers');
        const timerElement = document.querySelector('.timer span');
        const timerContainer = document.querySelector('.timer');

        // Timer
        function updateTimer() {
            seconds--;
            const minutes = Math.floor(seconds / 60);
            const secs = seconds % 60;
            timerElement.textContent = `${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            if (seconds <= 2 * 60) {
                timerContainer.classList.add('warning');
            }
            if (seconds <= 0) {
                clearInterval(timerInterval);
                if (!submitted) {
                    alert('Time is up! Submitting your test.');
                    submitTest();
                }
            }
        }

        // Highlight functionality
        function getValidSelection() {
            const sel = window.getSelection();
            if (!sel.rangeCount || sel.isCollapsed) return null;
            const range = sel.getRangeAt(0);
            if (passagePanel.contains(range.commonAncestorContainer)) {
                currentPanel = passagePanel;
            } else if (questionsPanel.contains(range.commonAncestorContainer)) {
                currentPanel = questionsPanel;
            } else {
                return null;
            }
            return range;
        }

        function showHighlightBtn(range) {
            const rect = range.getBoundingClientRect();
            highlightBtn.style.top = (window.scrollY + rect.top - 35) + 'px';
            highlightBtn.style.left = (window.scrollX + rect.left) + 'px';
            highlightBtn.style.display = 'block';
        }

        function hideHighlightBtn() {
            highlightBtn.style.display = 'none';
        }

        function showRemoveBtn(span) {
            const rect = span.getBoundingClientRect();
            removeHighlightBtn.style.top = (window.scrollY + rect.top - 35) + 'px';
            removeHighlightBtn.style.left = (window.scrollX + rect.left) + 'px';
            removeHighlightBtn.style.display = 'block';
            highlightTarget = span;
        }

        function hideRemoveBtn() {
            removeHighlightBtn.style.display = 'none';
            highlightTarget = null;
        }

        highlightBtn.addEventListener('click', () => {
            if (lastSelection) {
                const span = document.createElement('span');
                span.className = 'highlight';
                span.appendChild(lastSelection.extractContents());
                lastSelection.insertNode(span);
                window.getSelection().removeAllRanges();
                hideHighlightBtn();
            }
        });

        removeHighlightBtn.addEventListener('click', () => {
            if (highlightTarget) {
                const parent = highlightTarget.parentNode;
                while (highlightTarget.firstChild) {
                    parent.insertBefore(highlightTarget.firstChild, highlightTarget);
                }
                parent.removeChild(highlightTarget);
                hideRemoveBtn();
            }
        });

        document.addEventListener('selectionchange', () => {
            hideHighlightBtn();
            hideRemoveBtn();
            const range = getValidSelection();
            if (range) {
                lastSelection = range;
                showHighlightBtn(range);
            } else {
                lastSelection = null;
            }
        });

        [passagePanel, questionsPanel].forEach(panel => {
            panel.addEventListener('scroll', () => {
                hideHighlightBtn();
                hideRemoveBtn();
            });
        });

        document.addEventListener('mousedown', (e) => {
            if (e.target !== highlightBtn && e.target !== removeHighlightBtn) {
                hideHighlightBtn();
                hideRemoveBtn();
            }
        });

        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('highlight')) {
                e.preventDefault();
                showRemoveBtn(e.target);
            }
        });

        // Resizer
        resizer.addEventListener('mousedown', (e) => {
            isResizing = true;
            document.body.style.cursor = 'col-resize';
            document.body.style.userSelect = 'none';
        });

        document.addEventListener('mousemove', (e) => {
            if (!isResizing) return;
            const container = document.querySelector('.main-content');
            const containerRect = container.getBoundingClientRect();
            const mouseX = e.clientX - containerRect.left;
            const containerWidth = containerRect.width;
            const leftPercentage = (mouseX / containerWidth) * 100;
            const rightPercentage = 100 - leftPercentage;
            if (leftPercentage >= 30 && leftPercentage <= 70) {
                document.querySelector('.passage-container').style.flex = leftPercentage + '%';
                document.querySelector('.questions-container').style.width = rightPercentage + '%';
            }
        });

        document.addEventListener('mouseup', () => {
            if (isResizing) {
                isResizing = false;
                document.body.style.cursor = '';
                document.body.style.userSelect = '';
            }
        });

        // Navigation
        function scrollToQuestion(num) {
            const el = document.querySelector(`[data-question="${num}"]`);
            if (el) el.scrollIntoView({ behavior: 'smooth', block: 'center' });
            updateCurrentQuestion(num);
        }

        function updateCurrentQuestion(num) {
            currentQuestion = num;
            document.querySelectorAll('.progress-item').forEach(item => {
                item.classList.remove('current');
                if (item.dataset.question == num) item.classList.add('current');
            });
            prevBtn.disabled = num <= 27;
            nextBtn.disabled = num >= 40;
        }

        document.querySelectorAll('.progress-item').forEach(item => {
            item.addEventListener('click', () => {
                scrollToQuestion(parseInt(item.dataset.question));
            });
        });

        prevBtn.addEventListener('click', () => {
            if (currentQuestion > 27) scrollToQuestion(currentQuestion - 1);
        });

        nextBtn.addEventListener('click', () => {
            if (currentQuestion < 40) scrollToQuestion(currentQuestion + 1);
        });

        document.querySelectorAll('input[type="radio"], select').forEach(input => {
            input.addEventListener('change', () => {
                if (submitted) return;
                const qNumMatch = input.name.match(/^q(\d+)$/);
                if (qNumMatch) {
                    const qNum = parseInt(qNumMatch[1]);
                    const item = document.querySelector(`.progress-item[data-question="${qNum}"]`);
                    if (item && !item.classList.contains('answered')) {
                        item.classList.add('answered');
                    }
                }
            });
        });

        submitBtn.addEventListener('click', submitTest);

        function submitTest() {
            if (submitted) return;
            if (!confirm('Are you sure you want to submit?')) return;
            submitted = true;
            clearInterval(timerInterval);
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<i class="fas fa-check"></i> Submitted';
            let score = 0;
            const results = {};
            // Score all questions 27-40
            for (let i = 27; i <= 40; i++) {
                const key = `q${i}`;
                let userAnswer = '';
                let isCorrect = false;
                const radioEl = document.querySelector(`input[name="${key}"]:checked`);
                if (radioEl) {
                    userAnswer = radioEl.value;
                    isCorrect = userAnswer === correctAnswers[key];
                    document.querySelectorAll(`input[name="${key}"]`).forEach(r => r.disabled = true);
                }
                const selectEl = document.querySelector(`select[name="${key}"]`);
                if (selectEl) {
                    userAnswer = selectEl.value;
                    isCorrect = userAnswer === correctAnswers[key];
                    selectEl.disabled = true;
                }
                if (isCorrect) score++;
                results[key] = { userAnswer, correct: correctAnswers[key], isCorrect };
            }
            // Update score display
            scoreDisplay.textContent = `${score}/14`;
            passage3Score.textContent = `${score}/14`;
            // Update progress indicators
            for (let i = 27; i <= 40; i++) {
                const item = document.querySelector(`.progress-item[data-question="${i}"]`);
                const res = results[`q${i}`];
                if (item && res) {
                    item.classList.remove('current', 'answered');
                    item.classList.add(res.isCorrect ? 'correct' : 'incorrect');
                }
            }
            window.testResults = results;
            resultsModal.style.display = 'flex';
        }

        function showCorrectAnswers() {
            if (!submitted) return;
            document.querySelectorAll('.answer-indicator').forEach(el => el.remove());
            for (let i = 27; i <= 40; i++) {
                const key = `q${i}`;
                const res = window.testResults[key];
                if (!res) continue;
                let targetElement;
                const radioGroup = document.querySelector(`input[name="${key}"]`);
                const selectEl = document.querySelector(`select[name="${key}"]`);
                if (radioGroup) targetElement = radioGroup.closest('.question');
                else if (selectEl) targetElement = selectEl.parentNode;
                if (!targetElement) continue;
                const div = document.createElement('div');
                div.className = 'answer-indicator';
                div.classList.add(res.isCorrect ? 'correct' : 'incorrect');
                if (res.isCorrect) {
                    div.innerHTML = `<i class="fas fa-check"></i> Correct! You chose: <strong>${res.userAnswer}</strong>`;
                } else {
                    const userDisplay = res.userAnswer || 'No answer';
                    div.innerHTML = `<i class="fas fa-times"></i> Incorrect. You chose: <strong>${userDisplay}</strong><br><strong>Correct:</strong> ${res.correct}`;
                }
                targetElement.appendChild(div);
            }
        }

        closeModalBtn.addEventListener('click', () => {
            resultsModal.style.display = 'none';
        });

        reviewBtn.addEventListener('click', () => {
            resultsModal.style.display = 'none';
            showCorrectAnswers();
            scrollToQuestion(27);
        });

        function startTest() {
            document.getElementById('startScreen').classList.add('hidden');
            document.getElementById('testContainer').classList.remove('hidden');
            timerInterval = setInterval(updateTimer, 1000);
        }

        setTimeout(() => {
            document.getElementById('loadingScreen').classList.add('hidden');
            document.getElementById('startScreen').classList.remove('hidden');
        }, 2000);
    </script>
</body>

</html>