<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
            overflow: hidden;
        }

        .loading-screen {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #f9fafb;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 9999;
        }

        .loading-content {
            text-align: center;
        }

        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: #2563eb;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .loading-title {
            font-size: 1.2rem;
            color: #6b7280;
            margin-bottom: 20px;
        }

        .loading-subtitle {
            font-size: 1rem;
            color: #9ca3af;
        }

        .start-screen {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #f9fafb;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 9998;
        }

        .start-content {
            text-align: center;
        }

        .start-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #111827;
            margin-bottom: 24px;
        }

        .start-subtitle {
            color: #6b7280;
            margin-bottom: 24px;
        }

        .start-button {
            padding: 12px 32px;
            background-color: #2563eb;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .start-button:hover {
            background-color: #1d4ed8;
        }

        .hidden {
            display: none !important;
        }

        .container {
            display: flex;
            flex-direction: column;
            height: 100vh;
            width: 100vw;
            background: white;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        header {
            background-color: #ffffff;
            color: #333;
            padding: 8px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 100;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            flex-shrink: 0;
            border-bottom: 1px solid #e2e8f0;
        }

        .passage-info {
            font-size: 0.9rem;
            font-weight: 500;
            color: #2d3748;
        }

        .timer {
            background-color: rgba(255, 193, 193, 0.5);
            padding: 6px 12px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.3s;
            min-width: 80px;
            text-align: center;
            font-size: 0.9rem;
            color: #c53030;
            border: 1px solid rgba(255, 120, 120, 0.3);
        }

        .timer.warning {
            color: #9b2c2c;
            background-color: rgba(254, 178, 178, 0.7);
            border-color: rgba(245, 101, 101, 0.5);
        }

        .logo-area {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background-color: #007bff;
            color: white;
            text-decoration: none;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0, 123, 255, 0.3);
            cursor: pointer;
        }

        .logo-area:hover {
            background-color: #0056b3;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 123, 255, 0.4);
        }

        .logo-area i {
            font-size: 1.1rem;
        }

        .progress-container {
            background-color: #f8f9fa;
            padding: 4px 20px;
            z-index: 100;
            flex-shrink: 0;
            border-top: 1px solid #e2e8f0;
        }

        .progress-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 5px;
        }

        .progress-items {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }

        .nav-buttons {
            display: flex;
            gap: 6px;
        }

        .progress-item {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #4a5568;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.95rem;
            border: 1px solid #cbd5e0;
        }

        .progress-item.current {
            background-color: #4299e1;
            color: white;
            transform: scale(1.1);
            border-color: #2b6cb0;
        }

        .progress-item.answered {
            background-color: #9ae6b4;
            color: #22543d;
            border-color: #68d391;
        }

        .progress-item.correct {
            background-color: #48bb78;
            color: white;
            border-color: #38a169;
        }

        .progress-item.incorrect {
            background-color: #fed7d7;
            color: #c53030;
            border-color: #feb2b2;
        }

        .progress-item:hover {
            background-color: #cbd5e0;
            transform: scale(1.05);
        }

        .btn {
            padding: 6px 14px;
            border: 1px solid #cbd5e0;
            border-radius: 4px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.95rem;
            background-color: #f7fafc;
            color: #4a5568;
        }

        .btn i {
            font-size: 1rem;
        }

        .btn:hover {
            background-color: #edf2f7;
            border-color: #a0aec0;
        }

        .btn-primary,
        .btn-secondary {
            background-color: #f7fafc;
            color: #4a5568;
            border: 1px solid #cbd5e0;
        }

        .btn-primary:hover,
        .btn-secondary:hover {
            background-color: #edf2f7;
            border-color: #a0aec0;
        }

        .btn-submit {
            background-color: #48bb78;
            color: white;
            font-weight: 900;
            border: 1px solid #38a169;
        }

        .btn-submit:hover {
            background-color: #38a169;
            border-color: #2f855a;
        }

        .btn-submit:disabled {
            background-color: #9ae6b4;
            color: #718096;
            cursor: not-allowed;
            border: 1px solid #68d391;
        }

        .main-content {
            display: flex;
            flex: 1;
            overflow: hidden;
            position: relative;
        }

        .passage-container {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background-color: #fafafa;
            position: relative;
        }

        .resizer {
            width: 4px;
            background-color: #cbd5e0;
            cursor: col-resize;
            position: relative;
            transition: background-color 0.2s;
        }

        .resizer:hover {
            background-color: #a0aec0;
        }

        .resizer::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 30px;
            height: 60px;
            background-color: rgba(203, 213, 224, 0.5);
            border-radius: 4px;
            pointer-events: none;
        }

        .questions-container {
            width: 40%;
            padding: 20px;
            overflow-y: auto;
            background-color: white;
            border-left: 1px solid #e2e8f0;
        }

        .section-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 20px;
            padding-bottom: 8px;
            border-bottom: 2px solid #e2e8f0;
        }

        .passage-content p {
            margin-top: 15px;
            margin-bottom: 20px;
            text-align: justify;
        }

        .question {
            margin-bottom: 25px;
            padding: 15px;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            background-color: #ffffff;
            transition: box-shadow 0.2s;
        }

        .question:hover {
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .question-text {
            font-weight: 500;
            margin-bottom: 12px;
            color: #2d3748;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .option {
            display: flex;
            align-items: center;
            padding: 8px 12px;
            border: 1px solid #e2e8f0;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.9rem;
        }

        .option:hover {
            background-color: #f7fafc;
            border-color: #cbd5e0;
        }

        .option input {
            margin-right: 2px;
            width: 16px;
            height: 16px;
        }

        .input-field {
            padding: 8px 10px;
            border: 1px solid #e2e8f0;
            border-radius: 4px;
            width: 180px;
            margin: 0 6px;
            font-size: 0.9rem;
        }

        .input-field:focus {
            border-color: #4299e1;
            outline: none;
            box-shadow: 0 0 0 2px rgba(66, 153, 225, 0.2);
        }

        select.input-field {
            padding: 8px 10px;
        }

        .summary-select {
            padding: 4px 8px;
            border: 1px solid #e2e8f0;
            border-radius: 4px;
            margin: 0 4px;
            font-size: 0.9rem;
        }

        .question-group {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .question-group-title {
            font-weight: 600;
            margin-bottom: 12px;
            color: #2d3748;
            font-size: 1rem;
        }

        .answer-indicator {
            background-color: #e6fffa;
            border: 1px solid #38b2ac;
            padding: 10px;
            border-radius: 4px;
            margin-top: 10px;
            font-size: 0.9rem;
        }

        .answer-indicator.correct {
            background-color: #e6fffa;
            border-color: #38b2ac;
            color: #234e52;
        }

        .answer-indicator.incorrect {
            background-color: #fed7d7;
            border-color: #fc8181;
            color: #742a2a;
        }

        .highlight {
            background-color: #ffff00;
            cursor: pointer;
        }

        #highlight-btn,
        #remove-highlight-btn {
            position: absolute;
            z-index: 9999;
            display: none;
            padding: 6px 12px;
            font-size: 14px;
            border: 1px solid #888;
            border-radius: 4px;
            cursor: pointer;
            background-color: white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            width: 90%;
            max-width: 450px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .score-display {
            font-size: 2.2rem;
            font-weight: bold;
            margin: 20px 0;
            color: #2d3748;
        }

        .score-breakdown {
            margin: 20px 0;
            text-align: left;
        }

        .score-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #e2e8f0;
            font-size: 0.95rem;
        }

        .modal-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
        }

        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }

            .questions-container {
                width: 100%;
                border-left: none;
                border-top: 1px solid #e2e8f0;
            }

            .resizer {
                width: 100%;
                height: 4px;
                cursor: row-resize;
            }

            .resizer::before {
                width: 60px;
                height: 30px;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
            }

            .progress-item {
                width: 32px;
                height: 32px;
                font-size: 0.85rem;
            }

            header {
                flex-direction: column;
                gap: 10px;
                padding: 10px;
            }
        }
    </style>
</head>

<body>
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-content">
            <div class="spinner"></div>
            <h2 class="loading-title">Your test will begin shortly</h2>
            <p class="loading-subtitle">Please wait</p>
        </div>
    </div>

    <!-- Start Screen -->
    <div id="startScreen" class="start-screen hidden">
        <div class="start-content">
            <h1 class="start-title">IELTSwithJurabek</h1>
            <p class="start-subtitle">Ready to begin your reading test?</p>
            <button class="start-button" onclick="startTest()">Start Test</button>
        </div>
    </div>

    <!-- Test Container -->
    <div class="container hidden" id="testContainer">
        <header>
            <div class="passage-info">IELTSwithJurabek – Reading Passage 3</div>
            <div class="timer">
                <i class="fas fa-clock"></i>
                <span>20:00</span>
            </div>
            <div class="logo-area" onclick="window.open('https://t.me/IELTSwithJurabek', '_blank')">
                <i class="fas fa-paper-plane"></i>
                <span>Click for more TESTS</span>
            </div>
        </header>

        <button id="highlight-btn" type="button">Highlight</button>
        <button id="remove-highlight-btn" type="button">Remove Highlight</button>

        <div class="main-content">
            <!-- Reading Passage -->
            <div class="passage-container" role="region" aria-label="Reading Passage">
                <h2 class="section-title">READING PASSAGE 3</h2>
                <div class="passage-content" id="passage">
                    <h3>Neanderthal Technology</h3>
                    <p id="A3"><span class="label"><strong>A</strong></span> We think of our prehistoric ancestors as
                        people of the ice and snow, living in caves, and for many of the west European Neanderthalers
                        that is a just picture of their life. But where there were no caves, further to the east on the
                        Russian steppe, for example, open-air sites with some sort of constructed shelter were the only
                        option.</p>
                    <p id="B3"><span class="label"><strong>B</strong></span> We now know much more about the cave sites
                        than the open-air ones because, historically, it was the cave sites of Western Europe that were
                        first explored by archaeologists and also because open-air sites are harder to find – many of
                        them have disappeared under deep mud deposits or under the rising postglacial seas. Caves,
                        moreover, aid the survival of archaeological material and can preserve the records of remote
                        millennia.</p>
                    <p id="C3"><span class="label"><strong>C</strong></span> In south-west France, the limestone caves of
                        the Périgord region made ideal homes for the Neanderthal people. There were good supplies of
                        flint to hand for axes and the like, and the caves were often sited in small river valleys that
                        offered protection against the worst of the weather. The Neanderthalers liked south-facing
                        caves, for obvious reasons of sunshine and wind avoidance, and caves at some height above the
                        valley floor offered refuge from floods and good game-watching vantage points.</p>
                    <p id="D3"><span class="label"><strong>D</strong></span> The Périgord region during the last ice age
                        was, in fact, an exceptionally benign habitat for humans. It enjoyed a rather maritime climate
                        with cooler summers that permitted the extension of tundra and steppe over its higher plateaux,
                        and its year-round high levels of sunshine favoured the growth of the ground plants needed by
                        reindeer, bison and horse. Winters were mildish for the ice age, animals never needed to
                        migrate far from summer to winter, and men never needed to travel far from home to find
                        abundant supplies of meat.</p>
                    <p id="E3"><span class="label"><strong>E</strong></span> In Central and Eastern Europe, where caves
                        were unavailable, such open-air sites as have been discovered were mostly located near water –
                        both because this was a good area to be for people and animals, and also because the
                        sedimentation potential of lakes and stream courses has aided archaeological preservation –
                        whereas erosion has presumably blown away sites which were out in the open. Some of the
                        open-air sites in Germany, Central Europe and Russia have provided valuable information about
                        Neanderthal man and his way of life. From Moldova, for example, comes evidence that has been
                        interpreted as the remains of wind-break structures, or even a large tent: a ring, up to about
                        8 x 5m in size, of mainly mammoth bones enclosing a dense concentration of stone tools, animal
                        bones and ash.</p>
                    <p id="F3"><span class="label"><strong>F</strong></span> From the west European caves more evidence
                        of built structures is available, and some of it goes back a long way in time. In the Grotte du
                        Lazaret, near Nice, at a date during the last ice age but one, claims for some sort of skin tent
                        within the cave have been advanced, on the basis of arrangements of large stones out from the
                        cave wall that might have supported timber struts for a covering of skins up to the rock face
                        above. At Lazaret, what might be openings in the hypothesised tents seem to point away from the
                        cave mouth, and finds of wolf and fox foot bones, without the rest of the skeletons, inside
                        these ‘tents’ have been thought to indicate the use of animal pelts as bed coverings. The two
                        patches of ash at Lazaret that mark ancient fires, with stone tools around them evidently made
                        and used on the spot, are edged with small marine mollusc shells, prompting the excavator to
                        suggest that seaweed had been used as bedding around the fires. The cave of Baume-Bonne in the
                        Basses-Alpes region of France, another early site, boasts ten square metres of cobbles brought
                        up from the local river and laid down, as though to take care of a puddle area in the cave,
                        with the smoothest and roundest surfaces of the stones uppermost, and there are other similar
                        cases.</p>
                    <p id="G3"><span class="label"><strong>G</strong></span> The ash encountered in concentrations at
                        some sites testifies to the Neanderthal people’s use of fire: not surprising, since use of fire
                        was, by Neanderthal times, an already ancient accomplishment of evolving humanity, and survival
                        in the sub-arctic conditions faced by the Neanderthalers is inconceivable without control of
                        fire. Fire gave warmth, light, heat for cooking and defence against predatory animals. A charred
                        piece of birch from Krapina in Croatia, is thought to be the remains of a fire-making twirl
                        stick. But Neanderthal hearths, in the sense of specially constructed places for fire, are fewer
                        and harder to identify with certainty than the mere ash piles that are a regular feature of
                        their sites. They seem often to have just lit a small fire (40-50cm across) on the existing
                        ground surface of the cave, without preparation. Judging from the shallow penetration of heat
                        effects under the ash, this fire was only of a short duration. Sometimes the fires were larger
                        in size, up to one metre across, and quite irregular in shape. It is not always easy to decide
                        how much additional structure some fires possessed: claims of stone circles to contain the fire
                        run up against the fact that stones tend to litter the cave floors everywhere and those around a
                        fire can quite accidentally look as though they were arranged in a circle.</p>
                </div>
            </div>

            <div class="resizer" id="resizer"></div>

            <!-- Questions -->
            <div class="questions-container" id="questions" role="region" aria-label="Questions">
                <h2 class="section-title">Questions 27–40</h2>
                <p>You should spend about 20 minutes on Questions 27–40, which are based on Reading Passage 3.</p>

                <!-- 27-31 Headings -->
                <div class="question-group">
                    <div class="question-group-title">Questions 27–31</div>
                    <p>Reading Passage 3 has five sections. Choose the correct heading for each section from the
                        list of headings below. Write the correct number, <strong>i–vi</strong>, in boxes
                        <strong>27–31</strong>.
                    </p>
                    <p><strong>List of Headings</strong><br>
                        i. Evidence of outdoor dwellings<br>
                        ii. Learning to make fire<br>
                        iii. A perfect place to live<br>
                        iv. Examining the cave contents<br>
                        v. Contrasting two types of home<br>
                        vi. A vital source of power
                    </p>

                    <div class="question" data-question="27">
                        <div class="question-text">27. Paragraph A</div>
                        <select name="q27" class="input-field">
                            <option value="">Select a heading</option>
                            <option value="i">i</option>
                            <option value="ii">ii</option>
                            <option value="iii">iii</option>
                            <option value="iv">iv</option>
                            <option value="v">v</option>
                            <option value="vi">vi</option>
                        </select>
                    </div>

                    <div class="question" data-question="28">
                        <div class="question-text">28. Paragraph B</div>
                        <select name="q28" class="input-field">
                            <option value="">Select a heading</option>
                            <option value="i">i</option>
                            <option value="ii">ii</option>
                            <option value="iii">iii</option>
                            <option value="iv">iv</option>
                            <option value="v">v</option>
                            <option value="vi">vi</option>
                        </select>
                    </div>

                    <div class="question" data-question="29">
                        <div class="question-text">29. Paragraph C</div>
                        <select name="q29" class="input-field">
                            <option value="">Select a heading</option>
                            <option value="i">i</option>
                            <option value="ii">ii</option>
                            <option value="iii">iii</option>
                            <option value="iv">iv</option>
                            <option value="v">v</option>
                            <option value="vi">vi</option>
                        </select>
                    </div>

                    <div class="question" data-question="30">
                        <div class="question-text">30. Paragraph D</div>
                        <select name="q30" class="input-field">
                            <option value="">Select a heading</option>
                            <option value="i">i</option>
                            <option value="ii">ii</option>
                            <option value="iii">iii</option>
                            <option value="iv">iv</option>
                            <option value="v">v</option>
                            <option value="vi">vi</option>
                        </select>
                    </div>

                    <div class="question" data-question="31">
                        <div class="question-text">31. Paragraph E</div>
                        <select name="q31" class="input-field">
                            <option value="">Select a heading</option>
                            <option value="i">i</option>
                            <option value="ii">ii</option>
                            <option value="iii">iii</option>
                            <option value="iv">iv</option>
                            <option value="v">v</option>
                            <option value="vi">vi</option>
                        </select>
                    </div>
                </div>

                <!-- 32-36 Matching places -->
                <div class="question-group">
                    <div class="question-group-title">Questions 32–36</div>
                    <p>Look at the following findings (Questions 32–36) and the list of places below. Match each
                        finding with the correct place A–E. NB You may use any letter more than once.</p>
                    <p><strong>List of Places</strong><br>
                        A. The Périgord region<br>
                        B. Moldova<br>
                        C. The Grotte du Lazaret<br>
                        D. The cave of Baume-Bonne<br>
                        E. Krapina
                    </p>

                    <div class="question" data-question="32">
                        <div class="question-text">32. a burnt piece of wood</div>
                        <select name="q32" class="input-field">
                            <option value="">Select a place</option>
                            <option value="A">A</option>
                            <option value="B">B</option>
                            <option value="C">C</option>
                            <option value="D">D</option>
                            <option value="E">E</option>
                        </select>
                    </div>

                    <div class="question" data-question="33">
                        <div class="question-text">33. evidence of efforts to prevent pools of water forming</div>
                        <select name="q33" class="input-field">
                            <option value="">Select a place</option>
                            <option value="A">A</option>
                            <option value="B">B</option>
                            <option value="C">C</option>
                            <option value="D">D</option>
                            <option value="E">E</option>
                        </select>
                    </div>

                    <div class="question" data-question="34">
                        <div class="question-text">34. the remains of sea creatures</div>
                        <select name="q34" class="input-field">
                            <option value="">Select a place</option>
                            <option value="A">A</option>
                            <option value="B">B</option>
                            <option value="C">C</option>
                            <option value="D">D</option>
                            <option value="E">E</option>
                        </select>
                    </div>

                    <div class="question" data-question="35">
                        <div class="question-text">35. a circular arrangement of animal bones</div>
                        <select name="q35" class="input-field">
                            <option value="">Select a place</option>
                            <option value="A">A</option>
                            <option value="B">B</option>
                            <option value="C">C</option>
                            <option value="D">D</option>
                            <option value="E">E</option>
                        </select>
                    </div>

                    <div class="question" data-question="36">
                        <div class="question-text">36. evidence suggesting the use of animal fur for warmth</div>
                        <select name="q36" class="input-field">
                            <option value="">Select a place</option>
                            <option value="A">A</option>
                            <option value="B">B</option>
                            <option value="C">C</option>
                            <option value="D">D</option>
                            <option value="E">E</option>
                        </select>
                    </div>
                </div>

                <!-- 37-39 Summary completion (text) -->
                <div class="question-group">
                    <div class="question-group-title">Questions 37–39</div>
                    <p>Complete the summary below. Write <strong>NO MORE THAN TWO WORDS</strong> from the passage
                        for each answer.</p>
                    <p><strong>The use of fire</strong><br>
                        Neanderthalers could not have survived without fire because the conditions they lived in
                        were <span class="question-text">37</span>
                        <input type="text" name="q37" class="input-field" maxlength="30">
                        . Most evidence of purpose-built fires takes the form of ash piles, features of which suggest
                        that the fires lasted a <span class="question-text">38</span>
                        <input type="text" name="q38" class="input-field" maxlength="30">
                        time. It is hard to be certain about the size and structure of the
                        fires, though they were certainly needed to protect the occupants from dangerous <span
                            class="question-text">39</span>
                        <input type="text" name="q39" class="input-field" maxlength="30">
                        , among other things.
                    </p>
                </div>

                <!-- 40 MCQ -->
                <div class="question-group">
                    <div class="question-group-title">Question 40</div>
                    <p>Choose the correct answer.</p>
                    <div class="question" data-question="40">
                        <div class="question-text">40. The purpose of the writer of this article is to</div>
                        <div class="options">
                            <label class="option"><input type="radio" name="q40" value="A">A. argue that Neanderthal homes
                                were
                                bigger than originally thought.</label>
                            <label class="option"><input type="radio" name="q40" value="B">B. explain why Neanderthal
                                people
                                migrated to Western Europe.</label>
                            <label class="option"><input type="radio" name="q40" value="C">C. discuss what is known about
                                Neanderthal settlements.</label>
                            <label class="option"><input type="radio" name="q40" value="D">D. track the progress of early
                                Neanderthal development.</label>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Progress & buttons -->
        <div class="progress-container">
            <div class="progress-nav">
                <div class="progress-items">
                    <div class="progress-item current" data-question="27">27</div>
                    <div class="progress-item" data-question="28">28</div>
                    <div class="progress-item" data-question="29">29</div>
                    <div class="progress-item" data-question="30">30</div>
                    <div class="progress-item" data-question="31">31</div>
                    <div class="progress-item" data-question="32">32</div>
                    <div class="progress-item" data-question="33">33</div>
                    <div class="progress-item" data-question="34">34</div>
                    <div class="progress-item" data-question="35">35</div>
                    <div class="progress-item" data-question="36">36</div>
                    <div class="progress-item" data-question="37">37</div>
                    <div class="progress-item" data-question="38">38</div>
                    <div class="progress-item" data-question="39">39</div>
                    <div class="progress-item" data-question="40">40</div>
                </div>
                <div class="nav-buttons">
                    <button class="btn btn-secondary" id="prev-btn" disabled><i class="fas fa-arrow-left"></i>
                        Previous</button>
                    <button class="btn btn-secondary" id="next-btn">Next <i class="fas fa-arrow-right"></i></button>
                    <button class="btn btn-submit" id="submit-btn">Submit Test <i
                            class="fas fa-paper-plane"></i></button>
                </div>
            </div>
        </div>
    </div>

    <!-- Results Modal -->
    <div class="modal" id="results-modal">
        <div class="modal-content">
            <h2>Test Results</h2>
            <div class="score-display" id="score-display">0/14</div>
            <div class="score-breakdown">
                <div class="score-item">
                    <span>Passage 3:</span>
                    <span id="passage3-score">0/14</span>
                </div>
            </div>
            <div class="modal-buttons">
                <button class="btn btn-secondary" id="close-modal">Close</button>
                <button class="btn btn-primary" id="review-answers">Review Answers</button>
            </div>
        </div>
    </div>

    <script>
        // Correct Answers for Questions 27–40 (your original key)
        const correctAnswers = {
            q27: "v",
            q28: "v",
            q29: "iii",
            q30: "iii",
            q31: "i",
            q32: "E",
            q33: "D",
            q34: "C",
            q35: "B",
            q36: "C",
            q37: "sub-arctic",
            q38: "short",
            q39: "animals",
            q40: "C"
        };

        let lastSelection = null;
        let highlightTarget = null;
        let currentPanel = null;
        let submitted = false;
        let currentQuestion = 27;
        let isResizing = false;
        let seconds = 20 * 60; // 20 minutes
        let timerInterval;

        const highlightBtn = document.getElementById('highlight-btn');
        const removeHighlightBtn = document.getElementById('remove-highlight-btn');
        const passagePanel = document.getElementById('passage');
        const questionsPanel = document.getElementById('questions');
        const resizer = document.getElementById('resizer');
        const submitBtn = document.getElementById('submit-btn');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const resultsModal = document.getElementById('results-modal');
        const scoreDisplay = document.getElementById('score-display');
        const passage3Score = document.getElementById('passage3-score');
        const closeModalBtn = document.getElementById('close-modal');
        const reviewBtn = document.getElementById('review-answers');
        const timerElement = document.querySelector('.timer span');
        const timerContainer = document.querySelector('.timer');

        // Timer
        function updateTimer() {
            seconds--;
            const minutes = Math.floor(seconds / 60);
            const secs = seconds % 60;
            timerElement.textContent = `${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            if (seconds <= 2 * 60) {
                timerContainer.classList.add('warning');
            }
            if (seconds <= 0) {
                clearInterval(timerInterval);
                if (!submitted) {
                    alert('Time is up! Submitting your test.');
                    submitTest();
                }
            }
        }

        // Highlight functionality
        function getValidSelection() {
            const sel = window.getSelection();
            if (!sel.rangeCount || sel.isCollapsed) return null;
            const range = sel.getRangeAt(0);
            if (passagePanel.contains(range.commonAncestorContainer)) {
                currentPanel = passagePanel;
            } else if (questionsPanel.contains(range.commonAncestorContainer)) {
                currentPanel = questionsPanel;
            } else {
                return null;
            }
            return range;
        }

        function showHighlightBtn(range) {
            const rect = range.getBoundingClientRect();
            highlightBtn.style.top = (window.scrollY + rect.top - 35) + 'px';
            highlightBtn.style.left = (window.scrollX + rect.left) + 'px';
            highlightBtn.style.display = 'block';
        }

        function hideHighlightBtn() {
            highlightBtn.style.display = 'none';
        }

        function showRemoveBtn(span) {
            const rect = span.getBoundingClientRect();
            removeHighlightBtn.style.top = (window.scrollY + rect.top - 35) + 'px';
            removeHighlightBtn.style.left = (window.scrollX + rect.left) + 'px';
            removeHighlightBtn.style.display = 'block';
            highlightTarget = span;
        }

        function hideRemoveBtn() {
            removeHighlightBtn.style.display = 'none';
            highlightTarget = null;
        }

        highlightBtn.addEventListener('click', () => {
            if (lastSelection) {
                const span = document.createElement('span');
                span.className = 'highlight';
                span.appendChild(lastSelection.extractContents());
                lastSelection.insertNode(span);
                window.getSelection().removeAllRanges();
                hideHighlightBtn();
            }
        });

        removeHighlightBtn.addEventListener('click', () => {
            if (highlightTarget) {
                const parent = highlightTarget.parentNode;
                while (highlightTarget.firstChild) {
                    parent.insertBefore(highlightTarget.firstChild, highlightTarget);
                }
                parent.removeChild(highlightTarget);
                hideRemoveBtn();
            }
        });

        document.addEventListener('selectionchange', () => {
            hideHighlightBtn();
            hideRemoveBtn();
            const range = getValidSelection();
            if (range) {
                lastSelection = range;
                showHighlightBtn(range);
            } else {
                lastSelection = null;
            }
        });

        [passagePanel, questionsPanel].forEach(panel => {
            panel.addEventListener('scroll', () => {
                hideHighlightBtn();
                hideRemoveBtn();
            });
        });

        document.addEventListener('mousedown', (e) => {
            if (e.target !== highlightBtn && e.target !== removeHighlightBtn) {
                hideHighlightBtn();
                hideRemoveBtn();
            }
        });

        document.addEventListener('click', (e) => {
            if (e.target.classList && e.target.classList.contains('highlight')) {
                e.preventDefault();
                showRemoveBtn(e.target);
            }
        });

        // Resizer
        resizer.addEventListener('mousedown', () => {
            isResizing = true;
            document.body.style.cursor = 'col-resize';
            document.body.style.userSelect = 'none';
        });

        document.addEventListener('mousemove', (e) => {
            if (!isResizing) return;
            const container = document.querySelector('.main-content');
            const containerRect = container.getBoundingClientRect();
            const mouseX = e.clientX - containerRect.left;
            const containerWidth = containerRect.width;
            const leftPercentage = (mouseX / containerWidth) * 100;
            const rightPercentage = 100 - leftPercentage;
            if (leftPercentage >= 30 && leftPercentage <= 70) {
                document.querySelector('.passage-container').style.flex = leftPercentage + '%';
                document.querySelector('.questions-container').style.width = rightPercentage + '%';
            }
        });

        document.addEventListener('mouseup', () => {
            if (isResizing) {
                isResizing = false;
                document.body.style.cursor = '';
                document.body.style.userSelect = '';
            }
        });

        // Navigation
        function scrollToQuestion(num) {
            const el = document.querySelector(`[data-question="${num}"]`);
            if (el) el.scrollIntoView({ behavior: 'smooth', block: 'center' });
            updateCurrentQuestion(num);
        }

        function updateCurrentQuestion(num) {
            currentQuestion = num;
            document.querySelectorAll('.progress-item').forEach(item => {
                item.classList.remove('current');
                if (item.dataset.question == num) item.classList.add('current');
            });
            prevBtn.disabled = num <= 27;
            nextBtn.disabled = num >= 40;
        }

        document.querySelectorAll('.progress-item').forEach(item => {
            item.addEventListener('click', () => {
                scrollToQuestion(parseInt(item.dataset.question));
            });
        });

        prevBtn.addEventListener('click', () => {
            if (currentQuestion > 27) scrollToQuestion(currentQuestion - 1);
        });

        nextBtn.addEventListener('click', () => {
            if (currentQuestion < 40) scrollToQuestion(currentQuestion + 1);
        });

        // Mark answered (radios, selects, text)
        document.querySelectorAll('input[type="radio"], select, input[type="text"]').forEach(input => {
            input.addEventListener('change', () => {
                if (submitted) return;
                const qNumMatch = input.name.match(/^q(\d+)$/);
                if (qNumMatch) {
                    const qNum = parseInt(qNumMatch[1]);
                    const item = document.querySelector(`.progress-item[data-question="${qNum}"]`);
                    if (item && !item.classList.contains('answered')) {
                        item.classList.add('answered');
                    }
                }
            });
        });

        submitBtn.addEventListener('click', submitTest);

        function submitTest() {
            if (submitted) return;
            if (!confirm('Are you sure you want to submit?')) return;
            submitted = true;
            clearInterval(timerInterval);
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<i class="fas fa-check"></i> Submitted';
            let score = 0;
            const results = {};
            for (let i = 27; i <= 40; i++) {
                const key = `q${i}`;
                let userAnswer = '';
                let isCorrect = false;

                // Radio (e.g. Q40)
                const radioEl = document.querySelector(`input[name="${key}"]:checked`);
                if (radioEl) {
                    userAnswer = radioEl.value;
                    isCorrect = userAnswer === correctAnswers[key];
                    document.querySelectorAll(`input[name="${key}"]`).forEach(r => r.disabled = true);
                }

                // Selects (headings & places)
                const selectEl = document.querySelector(`select[name="${key}"]`);
                if (selectEl) {
                    userAnswer = selectEl.value;
                    isCorrect = userAnswer === correctAnswers[key];
                    selectEl.disabled = true;
                }

                // Text inputs (37–39)
                const textEl = document.querySelector(`input[name="${key}"][type="text"]`);
                if (textEl) {
                    userAnswer = textEl.value.trim();
                    if (userAnswer) {
                        isCorrect = userAnswer.toLowerCase() === correctAnswers[key].toLowerCase();
                    } else {
                        isCorrect = false;
                    }
                    textEl.disabled = true;
                }

                if (isCorrect) score++;
                results[key] = { userAnswer, correct: correctAnswers[key], isCorrect };
            }
            scoreDisplay.textContent = `${score}/14`;
            passage3Score.textContent = `${score}/14`;

            for (let i = 27; i <= 40; i++) {
                const item = document.querySelector(`.progress-item[data-question="${i}"]`);
                const res = results[`q${i}`];
                if (item && res) {
                    item.classList.remove('current', 'answered');
                    item.classList.add(res.isCorrect ? 'correct' : 'incorrect');
                }
            }
            window.testResults = results;
            resultsModal.style.display = 'flex';
        }

        function showCorrectAnswers() {
            if (!submitted) return;
            document.querySelectorAll('.answer-indicator').forEach(el => el.remove());
            for (let i = 27; i <= 40; i++) {
                const key = `q${i}`;
                const res = window.testResults[key];
                if (!res) continue;

                let targetElement;
                const radioGroup = document.querySelector(`input[name="${key}"]`);
                const selectEl = document.querySelector(`select[name="${key}"]`);
                const textEl = document.querySelector(`input[name="${key}"][type="text"]`);

                if (radioGroup) targetElement = radioGroup.closest('.question');
                else if (selectEl) targetElement = selectEl.closest('.question');
                else if (textEl) targetElement = textEl.closest('.question');

                if (!targetElement) continue;

                const div = document.createElement('div');
                div.className = 'answer-indicator';
                div.classList.add(res.isCorrect ? 'correct' : 'incorrect');

                if (res.isCorrect) {
                    div.innerHTML = `<i class="fas fa-check"></i> Correct! You chose: <strong>${res.userAnswer}</strong>`;
                } else {
                    const userDisplay = res.userAnswer || 'No answer';
                    div.innerHTML = `<i class="fas fa-times"></i> Incorrect. You chose: <strong>${userDisplay}</strong><br><strong>Correct:</strong> ${res.correct}`;
                }
                targetElement.appendChild(div);
            }
        }

        closeModalBtn.addEventListener('click', () => {
            resultsModal.style.display = 'none';
        });

        reviewBtn.addEventListener('click', () => {
            resultsModal.style.display = 'none';
            showCorrectAnswers();
            scrollToQuestion(27);
        });

        function startTest() {
            document.getElementById('startScreen').classList.add('hidden');
            document.getElementById('testContainer').classList.remove('hidden');
            timerInterval = setInterval(updateTimer, 1000);
        }

        // Show start screen after loading screen
        setTimeout(() => {
            document.getElementById('loadingScreen').classList.add('hidden');
            document.getElementById('startScreen').classList.remove('hidden');
        }, 2000);
    </script>
</body>

</html>
