<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
            overflow: hidden;
        }

        .loading-screen {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #f9fafb;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 9999;
        }

        .loading-content {
            text-align: center;
        }

        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: #2563eb;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .loading-title {
            font-size: 1.2rem;
            color: #6b7280;
            margin-bottom: 20px;
        }

        .loading-subtitle {
            font-size: 1rem;
            color: #9ca3af;
        }

        .start-screen {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #f9fafb;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 9998;
        }

        .start-content {
            text-align: center;
        }

        .start-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #111827;
            margin-bottom: 24px;
        }

        .start-subtitle {
            color: #6b7280;
            margin-bottom: 24px;
        }

        .start-button {
            padding: 12px 32px;
            background-color: #2563eb;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .start-button:hover {
            background-color: #1d4ed8;
        }

        .hidden {
            display: none !important;
        }

        .container {
            display: flex;
            flex-direction: column;
            height: 100vh;
            width: 100vw;
            background: white;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        header {
            background-color: #ffffff;
            color: #333;
            padding: 8px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 100;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            flex-shrink: 0;
            border-bottom: 1px solid #e2e8f0;
        }

        .passage-info {
            font-size: 0.9rem;
            font-weight: 500;
            color: #2d3748;
        }

        .timer {
            background-color: rgba(255, 193, 193, 0.5);
            padding: 6px 12px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.3s;
            min-width: 80px;
            text-align: center;
            font-size: 0.9rem;
            color: #c53030;
            border: 1px solid rgba(255, 120, 120, 0.3);
        }

        .timer.warning {
            color: #9b2c2c;
            background-color: rgba(254, 178, 178, 0.7);
            border-color: rgba(245, 101, 101, 0.5);
        }

        .logo-area {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background-color: #007bff;
            color: white;
            text-decoration: none;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0, 123, 255, 0.3);
            cursor: pointer;
        }

        .logo-area:hover {
            background-color: #0056b3;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 123, 255, 0.4);
        }

        .logo-area i {
            font-size: 1.1rem;
        }

        .progress-container {
            background-color: #f8f9fa;
            padding: 4px 20px;
            z-index: 100;
            flex-shrink: 0;
            border-top: 1px solid #e2e8f0;
        }

        .progress-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 5px;
        }

        .progress-items {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }

        .nav-buttons {
            display: flex;
            gap: 6px;
        }

        .progress-item {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #4a5568;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.95rem;
            border: 1px solid #cbd5e0;
        }

        .progress-item.current {
            background-color: #4299e1;
            color: white;
            transform: scale(1.1);
            border-color: #2b6cb0;
        }

        .progress-item.answered {
            background-color: #9ae6b4;
            color: #22543d;
            border-color: #68d391;
        }

        .progress-item.correct {
            background-color: #48bb78;
            color: white;
            border-color: #38a169;
        }

        .progress-item.incorrect {
            background-color: #fed7d7;
            color: #c53030;
            border-color: #feb2b2;
        }

        .progress-item:hover {
            background-color: #cbd5e0;
            transform: scale(1.05);
        }

        .btn {
            padding: 6px 14px;
            border: 1px solid #cbd5e0;
            border-radius: 4px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.95rem;
            background-color: #f7fafc;
            color: #4a5568;
        }

        .btn i {
            font-size: 1rem;
        }

        .btn:hover {
            background-color: #edf2f7;
            border-color: #a0aec0;
        }

        .btn-primary {
            background-color: #f7fafc;
            color: #4a5568;
            border: 1px solid #cbd5e0;
        }

        .btn-primary:hover {
            background-color: #edf2f7;
            border-color: #a0aec0;
        }

        .btn-secondary {
            background-color: #f7fafc;
            color: #4a5568;
            border: 1px solid #cbd5e0;
        }

        .btn-secondary:hover {
            background-color: #edf2f7;
            border-color: #a0aec0;
        }

        .btn-submit {
            background-color: #48bb78;
            color: white;
            font-weight: 900;
            border: 1px solid #38a169;
        }

        .btn-submit:hover {
            background-color: #38a169;
            border-color: #2f855a;
        }

        .btn-submit:disabled {
            background-color: #9ae6b4;
            color: #718096;
            cursor: not-allowed;
            border: 1px solid #68d391;
        }

        .main-content {
            display: flex;
            flex: 1;
            overflow: hidden;
            position: relative;
        }

        .passage-container {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background-color: #fafafa;
            position: relative;
        }

        .resizer {
            width: 4px;
            background-color: #cbd5e0;
            cursor: col-resize;
            position: relative;
            transition: background-color 0.2s;
        }

        .resizer:hover {
            background-color: #a0aec0;
        }

        .resizer::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 30px;
            height: 60px;
            background-color: rgba(203, 213, 224, 0.5);
            border-radius: 4px;
            pointer-events: none;
        }

        .questions-container {
            width: 40%;
            padding: 20px;
            overflow-y: auto;
            background-color: white;
            border-left: 1px solid #e2e8f0;
        }

        .passage {
            max-width: 800px;
            margin: 0 auto;
        }

        .passage h2 {
            color: #2d3748;
            margin-bottom: 20px;
            font-size: 1.4rem;
        }

        .passage-content p {
            margin-top: 15px;
            margin-bottom: 20px;
            text-align: justify;
        }

        .passage h2 {
            color: #2d3748;
            margin-bottom: 20px;
            font-size: 1.4rem;
        }

        .passage p {
            margin-top: 20px;
            margin-bottom: 25px;
            text-align: justify;
        }

        .question-section {
            max-width: 800px;
            margin: 0 auto;
        }

        .section-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 20px;
            padding-bottom: 8px;
            border-bottom: 2px solid #e2e8f0;
        }

        .question {
            margin-bottom: 25px;
            padding: 1px;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            background-color: #ffffff;
            transition: box-shadow 0.2s;
        }

        .question:hover {
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .question-text {
            font-weight: 500;
            margin-bottom: 12px;
            color: #2d3748;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .option {
            display: flex;
            align-items: center;
            padding: 8px 12px;
            border: 1px solid #e2e8f0;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.9rem;
        }

        .option:hover {
            background-color: #f7fafc;
            border-color: #cbd5e0;
        }

        .option input {
            margin-right: 2px;
            width: 16px;
            height: 16px;
        }

        .input-field {
            padding: 8px 10px;
            border: 1px solid #e2e8f0;
            border-radius: 4px;
            width: 20%;
            margin-top: 5px;
            font-size: 0.9rem;
        }

        .input-field:focus {
            border-color: #4299e1;
            outline: none;
            box-shadow: 0 0 0 2px rgba(66, 153, 225, 0.2);
        }

        select.input-field {
            padding: 8px 10px;
            border: 1px solid #e2e8f0;
            border-radius: 4px;
            width: 20%;
            margin-top: 5px;
            font-size: 0.9rem;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            font-size: 0.9rem;
        }

        th,
        td {
            border: 1px solid #e2e8f0;
            padding: 10px;
            text-align: left;
        }

        th {
            background-color: #f1f5f9;
            font-weight: 600;
            color: #2d3748;
        }

        .answer-indicator {
            background-color: #e6fffa;
            border: 1px solid #38b2ac;
            padding: 10px;
            border-radius: 4px;
            margin-top: 10px;
            font-size: 0.9rem;
        }

        .answer-indicator.correct {
            background-color: #e6fffa;
            border-color: #38b2ac;
            color: #234e52;
        }

        .answer-indicator.incorrect {
            background-color: #fed7d7;
            border-color: #fc8181;
            color: #742a2a;
        }

        .question-group {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .question-group-title {
            font-weight: 600;
            margin-bottom: 12px;
            color: #2d3748;
            font-size: 1rem;
        }

        .highlight {
            background-color: #ffff00;
            cursor: pointer;
        }

        #highlight-btn,
        #remove-highlight-btn {
            position: absolute;
            z-index: 9999;
            display: none;
            padding: 6px 12px;
            font-size: 14px;
            border: 1px solid #888;
            border-radius: 4px;
            cursor: pointer;
            background-color: white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            width: 90%;
            max-width: 450px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .score-display {
            font-size: 2.2rem;
            font-weight: bold;
            margin: 20px 0;
            color: #2d3748;
        }

        .score-breakdown {
            margin: 20px 0;
            text-align: left;
        }

        .score-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #e2e8f0;
            font-size: 0.95rem;
        }

        .modal-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
        }

        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }

            .questions-container {
                width: 100%;
                border-left: none;
                border-top: 1px solid #e2e8f0;
            }

            .resizer {
                width: 100%;
                height: 4px;
                cursor: row-resize;
            }

            .resizer::before {
                width: 60px;
                height: 30px;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
            }

            .progress-item {
                width: 32px;
                height: 32px;
                font-size: 0.85rem;
            }

            .passage-info {
                font-size: 0.9rem;
            }

            header {
                flex-direction: column;
                gap: 10px;
                padding: 10px;
            }

            .logo-area {
                order: 1;
            }

            .passage-info {
                order: 2;
            }

            .timer {
                order: 3;
            }
        }

        @media (max-width: 480px) {
            .progress-item {
                width: 32px;
                height: 32px;
                font-size: 0.85rem;
            }

            .passage-info {
                font-size: 0.9rem;
            }
        }
    </style>
</head>


<body>
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-content">
            <div class="spinner"></div>
            <h2 class="loading-title">Your test will begin shortly</h2>
            <p class="loading-subtitle">Please wait</p>
        </div>
    </div>

    <!-- Start Screen -->
    <div id="startScreen" class="start-screen hidden">
        <div class="start-content">
            <h1 class="start-title">IELTSwithJurabek</h1>
            <p class="start-subtitle">Ready to begin your reading test?</p>
            <button class="start-button" onclick="startTest()">Start Test</button>
        </div>
    </div>

    <!-- Test Container -->
    <div class="container hidden" id="testContainer">
        <header>
            <div class="passage-info">IELTSwithJurabek</div>
            <div class="timer">
                <i class="fas fa-clock"></i>
                <span>20:00</span>
            </div>
            <div class="logo-area" onclick="window.open('https://t.me/IELTSwithJurabek', '_blank')">
                <i class="fas fa-paper-plane"></i>
                <span>Click for more TESTS</span>
            </div>
        </header>

        <button id="highlight-btn" type="button">Highlight</button>
        <button id="remove-highlight-btn" type="button">Remove Highlight</button>

        <div class="main-content">
            <!-- Reading Passage -->
            <div class="passage-container" role="region" aria-label="Reading Passage">
                <h2 class="section-title">READING PASSAGE 3</h2>
                <div class="passage-content" id="passage">
                    <h3>Improving Patient Safety</h3>
                    <p><strong>Packaging</strong><br>One of the most prominent design issues in pharmacy is that of drug
                        packages and the patient information leaflets (PILs) included in them. Many pharmacists are
                        concerned that current designs are 'accidents waiting to happen'. The UK government shares this
                        concern and, in 2003, the National Patient Safety Agency created a new role, appointing Colum
                        Lowe, who has 14 years' experience as a designer in the private sector, as head of design and
                        human factors.</p>
                    <p>Packaging design in the pharmaceutical industry is handled by either in-house teams or external
                        design agencies. For packaging design of over-the-counter medicines, which do not have to be
                        dispensed by a pharmacist but can be bought directly from a sales assistant, characteristics
                        such as attractiveness and distinguishability are important and so these are usually
                        commissioned from an external design team. The marketing team prepares the initial brief and the
                        designers come up with six or seven designs. Two or three of these are then tested on a consumer
                        group. In contrast, most designs for prescription-only products are created in-house. In some
                        cases, this may simply involve the company's design team applying the house design and then
                        handing it over to design engineers rather than testing the design on a consumer group. Clearly
                        this process cannot adequately address the needs of the wide variety of patients using
                        medication.</p>
                    <p><strong>Design consideration</strong><br>In her book <em>Information Design for Patient
                            Safety</em>, Thea Swayne highlighted a multitude of design problems. For example, drugs that
                        look or sound alike can lead to confusion; small type sizes and even the glare on silver foil
                        packaging can lead to names or instructions being misread. One such example is a drug that was
                        accidentally injected into a patient through the spine (intrathecally) rather than through the
                        veins (intravenously). Investigations following this tragedy attributed some blame to the poor
                        choice of typescript used on the drug container. Furthermore, according to Swayne, real
                        situations in which medicines are used include a parent giving a cough medicine to a child in
                        the middle of the night: packaging should be designed for moments such as these rather than for
                        the ideal world of a hospital.</p>
                    <p><strong>Safety and compliance</strong><br>Child protection is another area that gives designers
                        opportunities to improve safety. According to the Child Accident Prevention Trust, 70% of
                        children admitted to hospital with suspected poisoning have swallowed medicines, and although
                        child-resistant lids have helped, they are not yet fully effective. There is scope for improving
                        what is currently available, according to Richard Mawle, a freelance product designer who feels
                        it is not just children who are blocked by child-proof closures. 'Many child-resistant packs are
                        based on strength but older people may have the same level of strength as a child,' he
                        explained, and suggested that better designs could rely on cognitive skills (e.g. removing the
                        lid using a three-step process).</p>
                    <p>Mawle also worked on a project which involved applying his skills to packaging and PILs.
                        Commenting on the information presented, he said: 'There can be an awful lot of junk at the
                        beginning of PILs. For example, why are company details towards the beginning of a leaflet when
                        what might be more vital for the patient is that the medicine should not be taken with alcohol?'
                    </p>
                    <p><strong>Design principles and guidelines</strong><br>Most designers work according to basic
                        principles; for example, certain print styles are known to be more difficult to read than
                        others. Look-alike boxes present the potential for errors and an obvious solution would be to
                        use colours to highlight a larger dosage of a drug. However, according to Thea Swayne,
                        designating a colour to a particular dosage is not recommended because this could lead to the
                        user not reading the text on a box.</p>
                    <p>Design features can provide the basis for lengthy debates. One argument is that if all packaging
                        was white with black lettering, people would have no choice but to read every box carefully. The
                        problem is that trials of drug packaging are few - common signage studies concern road traffic
                        signs and visual display units. Although some designers take results from such studies into
                        account, proving that a particular feature is beneficial can be difficult. For example, current
                        UK legislation requires packaging to include the name of the medicine in Braille, but, according
                        to Karel van der Waarde, a design consultant to the pharmaceutical industry, it is not known how
                        much visually impaired patients will benefit nor how much the reading of visually able patients
                        will be impaired. Van der Waarde is sceptical about current legislation and says that many
                        regulatory authorities do not have the resources to handle packaging information properly. 'They
                        do not look at the use of packaging in a practical context - they only see one box at a time and
                        not several together as pharmacists would do,' he said.</p>
                    <p><strong>Innovation</strong><br>On a positive note, a recent innovation exhibition revealed
                        several new designs. 'The popper' aims to help arthritis sufferers remove tablets from blister
                        packs, and 'Pluspoint' is an adrenaline auto-injector (a device that allows diabetics to inject
                        themselves) aimed at overcoming the fact that many patients do not carry their medication due to
                        its prohibitive size. The aim of good design is to try to make things more user-friendly as well
                        as safer. The guidelines in <em>Information Design for Patient Safety</em> are not intended to
                        be legally binding. Rather, the book's purpose is to create a basic design standard and to
                        stimulate innovation. The challenge for the pharmaceutical industry is to adopt such a standard.
                    </p>
                </div>
            </div>

            <div class="resizer" id="resizer"></div>

            <!-- Questions -->
            <div class="questions-container" id="questions" role="region" aria-label="Questions">
                <h2 class="section-title">Questions 27-40</h2>
                <p>You should spend about 20 minutes on Questions 27â€“40, which are based on Reading Passage 3.</p>

                <div class="question-group">
                    <div class="question-group-title">Questions 27-32</div>
                    <p>Look at the following statements (Questions 27-32) and the list of people or groups below.<br>
                        Match each statement with the correct person or group, A, B, C, or D.<br>
                        Write the correct letter, A, B, C, or D, in boxes 27-32 on your answer sheet.<br>
                        NB You may use any letter more than once.</p>
                    <p><strong>List of People or Groups</strong><br>
                        A Thea Swayne<br>
                        B The Child Accident Prevention Trust<br>
                        C Richard Mawle<br>
                        D Karel van der Waarde</p>
                    <div class="question" data-question="27">
                        <div class="question-text">27. The elderly would benefit from drug containers that do not
                            require force to open them.</div>
                        <select name="q27" class="summary-select">
                            <option value="">Select</option>
                            <option value="A">A</option>
                            <option value="B">B</option>
                            <option value="C">C</option>
                            <option value="D">D</option>
                        </select>
                    </div>
                    <div class="question" data-question="28">
                        <div class="question-text">28. Adapting packaging for the blind may disadvantage people who can
                            see.</div>
                        <select name="q28" class="summary-select">
                            <option value="">Select</option>
                            <option value="A">A</option>
                            <option value="B">B</option>
                            <option value="C">C</option>
                            <option value="D">D</option>
                        </select>
                    </div>
                    <div class="question" data-question="29">
                        <div class="question-text">29. Specially designed containers have not been able to eliminate
                            drugs being swallowed accidentally.</div>
                        <select name="q29" class="summary-select">
                            <option value="">Select</option>
                            <option value="A">A</option>
                            <option value="B">B</option>
                            <option value="C">C</option>
                            <option value="D">D</option>
                        </select>
                    </div>
                    <div class="question" data-question="30">
                        <div class="question-text">30. Designers have to consider how drugs are used in the home.</div>
                        <select name="q30" class="summary-select">
                            <option value="">Select</option>
                            <option value="A">A</option>
                            <option value="B">B</option>
                            <option value="C">C</option>
                            <option value="D">D</option>
                        </select>
                    </div>
                    <div class="question" data-question="31">
                        <div class="question-text">31. Governing bodies need to compare different drug containers rather
                            than studying individual ones.</div>
                        <select name="q31" class="summary-select">
                            <option value="">Select</option>
                            <option value="A">A</option>
                            <option value="B">B</option>
                            <option value="C">C</option>
                            <option value="D">D</option>
                        </select>
                    </div>
                    <div class="question" data-question="32">
                        <div class="question-text">32. Information provided with medicine is not listed in the right
                            order.</div>
                        <select name="q32" class="summary-select">
                            <option value="">Select</option>
                            <option value="A">A</option>
                            <option value="B">B</option>
                            <option value="C">C</option>
                            <option value="D">D</option>
                        </select>
                    </div>
                </div>

                <div class="question-group">
                    <div class="question-group-title">Questions 33-37</div>
                    <p>Complete the summary using the list of words, A-G, below.<br>
                        Write the correct letter, A-G, in boxes 33-37 on your answer sheet.</p>
                    <p><strong>Packaging design in the pharmaceutical industry</strong></p>
                    <p><strong>Over-the-counter drugs</strong><br>
                        First, a proposal is written by the <span class="question" data-question="33"><select name="q33"
                                class="summary-select">
                                <option value="">Select</option>
                                <option value="A">A - consumers</option>
                                <option value="B">B - design engineers</option>
                                <option value="C">C - external design team</option>
                                <option value="D">D - in-house design team</option>
                                <option value="E">E - marketing team</option>
                                <option value="F">F - pharmaceutical industry</option>
                                <option value="G">G - pharmacists</option>
                            </select></span>. Then several designs are produced by the <span class="question"
                            data-question="34"><select name="q34" class="summary-select">
                                <option value="">Select</option>
                                <option value="A">A - consumers</option>
                                <option value="B">B - design engineers</option>
                                <option value="C">C - external design team</option>
                                <option value="D">D - in-house design team</option>
                                <option value="E">E - marketing team</option>
                                <option value="F">F - pharmaceutical industry</option>
                                <option value="G">G - pharmacists</option>
                            </select></span>. Finally, selected designs are shown to <span class="question"
                            data-question="35"><select name="q35" class="summary-select">
                                <option value="">Select</option>
                                <option value="A">A - consumers</option>
                                <option value="B">B - design engineers</option>
                                <option value="C">C - external design team</option>
                                <option value="D">D - in-house design team</option>
                                <option value="E">E - marketing team</option>
                                <option value="F">F - pharmaceutical industry</option>
                                <option value="G">G - pharmacists</option>
                            </select></span>.</p>
                    <p><strong>Prescription-only drugs</strong><br>
                        The <span class="question" data-question="36"><select name="q36" class="summary-select">
                                <option value="">Select</option>
                                <option value="A">A - consumers</option>
                                <option value="B">B - design engineers</option>
                                <option value="C">C - external design team</option>
                                <option value="D">D - in-house design team</option>
                                <option value="E">E - marketing team</option>
                                <option value="F">F - pharmaceutical industry</option>
                                <option value="G">G - pharmacists</option>
                            </select></span> create the design. The design is then passed to <span class="question"
                            data-question="37"><select name="q37" class="summary-select">
                                <option value="">Select</option>
                                <option value="A">A - consumers</option>
                                <option value="B">B - design engineers</option>
                                <option value="C">C - external design team</option>
                                <option value="D">D - in-house design team</option>
                                <option value="E">E - marketing team</option>
                                <option value="F">F - pharmaceutical industry</option>
                                <option value="G">G - pharmacists</option>
                            </select></span>.</p>
                </div>

                <div class="question-group">
                    <div class="question-group-title">Questions 38-40</div>
                    <p>Choose the correct letter A, B, C, or D.<br>
                        Write the correct letter in boxes 38-40 on your answer sheet.</p>
                    <div class="question" data-question="38">
                        <div class="question-text">38. In the accident mentioned in the passage, what was the 'design
                            consideration' that caused a drug to be given incorrectly?</div>
                        <div class="options">
                            <label class="option"><input type="radio" name="q38" value="A">A - a printing error</label>
                            <label class="option"><input type="radio" name="q38" value="B">B - the style of
                                print</label>
                            <label class="option"><input type="radio" name="q38" value="C">C - an incorrect
                                label</label>
                            <label class="option"><input type="radio" name="q38" value="D">D - the shape of the
                                bottle</label>
                        </div>
                    </div>
                    <div class="question" data-question="39">
                        <div class="question-text">39. What do some people say about the use of only black and white as
                            a design feature?</div>
                        <div class="options">
                            <label class="option"><input type="radio" name="q39" value="A">A - Consumers would dislike
                                this option.</label>
                            <label class="option"><input type="radio" name="q39" value="B">B - Drug containers would all
                                look too similar.</label>
                            <label class="option"><input type="radio" name="q39" value="C">C - People would pay more
                                attention to label information.</label>
                            <label class="option"><input type="radio" name="q39" value="D">D - Partially sighted people
                                would find these colours more helpful.</label>
                        </div>
                    </div>
                    <div class="question" data-question="40">
                        <div class="question-text">40. Why does the writer refer to 'the popper' and 'Pluspoint'?</div>
                        <div class="options">
                            <label class="option"><input type="radio" name="q40" value="A">A - to show that progress is
                                being made in pharmaceutical packaging design</label>
                            <label class="option"><input type="radio" name="q40" value="B">B - to give an example of
                                pharmaceutical design problems that can cause accidents</label>
                            <label class="option"><input type="radio" name="q40" value="C">C - to prove that a lot of
                                work still needs to be done to improve pharmaceutical packaging design</label>
                            <label class="option"><input type="radio" name="q40" value="D">D - to point out that
                                patients need to be more informed about pharmaceutical products</label>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="progress-container">
            <div class="progress-nav">
                <div class="progress-items">
                    <div class="progress-item current" data-question="27">27</div>
                    <div class="progress-item" data-question="28">28</div>
                    <div class="progress-item" data-question="29">29</div>
                    <div class="progress-item" data-question="30">30</div>
                    <div class="progress-item" data-question="31">31</div>
                    <div class="progress-item" data-question="32">32</div>
                    <div class="progress-item" data-question="33">33</div>
                    <div class="progress-item" data-question="34">34</div>
                    <div class="progress-item" data-question="35">35</div>
                    <div class="progress-item" data-question="36">36</div>
                    <div class="progress-item" data-question="37">37</div>
                    <div class="progress-item" data-question="38">38</div>
                    <div class="progress-item" data-question="39">39</div>
                    <div class="progress-item" data-question="40">40</div>
                </div>
                <div class="nav-buttons">
                    <button class="btn btn-secondary" id="prev-btn" disabled><i class="fas fa-arrow-left"></i>
                        Previous</button>
                    <button class="btn btn-secondary" id="next-btn">Next <i class="fas fa-arrow-right"></i></button>
                    <button class="btn btn-submit" id="submit-btn">Submit Test <i
                            class="fas fa-paper-plane"></i></button>
                </div>
            </div>
        </div>
    </div>

    <!-- Results Modal -->
    <div class="modal" id="results-modal">
        <div class="modal-content">
            <h2>Test Results</h2>
            <div class="score-display" id="score-display">0/14</div>
            <div class="score-breakdown">
                <div class="score-item">
                    <span>Passage 3:</span>
                    <span id="passage3-score">0/14</span>
                </div>
            </div>
            <div class="modal-buttons">
                <button class="btn btn-secondary" id="close-modal">Close</button>
                <button class="btn btn-primary" id="review-answers">Review Answers</button>
            </div>
        </div>
    </div>

    <script>
        // Correct Answers for Questions 27-40
        const correctAnswers = {
            q27: "C",
            q28: "D",
            q29: "B",
            q30: "A",
            q31: "D",
            q32: "C",
            q33: "E",
            q34: "C",
            q35: "A",
            q36: "D",
            q37: "B",
            q38: "B",
            q39: "C",
            q40: "A"
        };

        let lastSelection = null;
        let highlightTarget = null;
        let currentPanel = null;
        let submitted = false;
        let currentQuestion = 27;
        let isResizing = false;
        let seconds = 20 * 60; // 20 minutes
        let timerInterval;

        const highlightBtn = document.getElementById('highlight-btn');
        const removeHighlightBtn = document.getElementById('remove-highlight-btn');
        const passagePanel = document.getElementById('passage');
        const questionsPanel = document.getElementById('questions');
        const resizer = document.getElementById('resizer');
        const submitBtn = document.getElementById('submit-btn');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const resultsModal = document.getElementById('results-modal');
        const scoreDisplay = document.getElementById('score-display');
        const passage3Score = document.getElementById('passage3-score');
        const closeModalBtn = document.getElementById('close-modal');
        const reviewBtn = document.getElementById('review-answers');
        const timerElement = document.querySelector('.timer span');
        const timerContainer = document.querySelector('.timer');

        // Timer
        function updateTimer() {
            seconds--;
            const minutes = Math.floor(seconds / 60);
            const secs = seconds % 60;
            timerElement.textContent = `${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            if (seconds <= 2 * 60) {
                timerContainer.classList.add('warning');
            }
            if (seconds <= 0) {
                clearInterval(timerInterval);
                if (!submitted) {
                    alert('Time is up! Submitting your test.');
                    submitTest();
                }
            }
        }

        // Highlight functionality
        function getValidSelection() {
            const sel = window.getSelection();
            if (!sel.rangeCount || sel.isCollapsed) return null;
            const range = sel.getRangeAt(0);
            if (passagePanel.contains(range.commonAncestorContainer)) {
                currentPanel = passagePanel;
            } else if (questionsPanel.contains(range.commonAncestorContainer)) {
                currentPanel = questionsPanel;
            } else {
                return null;
            }
            return range;
        }

        function showHighlightBtn(range) {
            const rect = range.getBoundingClientRect();
            highlightBtn.style.top = (window.scrollY + rect.top - 35) + 'px';
            highlightBtn.style.left = (window.scrollX + rect.left) + 'px';
            highlightBtn.style.display = 'block';
        }

        function hideHighlightBtn() {
            highlightBtn.style.display = 'none';
        }

        function showRemoveBtn(span) {
            const rect = span.getBoundingClientRect();
            removeHighlightBtn.style.top = (window.scrollY + rect.top - 35) + 'px';
            removeHighlightBtn.style.left = (window.scrollX + rect.left) + 'px';
            removeHighlightBtn.style.display = 'block';
            highlightTarget = span;
        }

        function hideRemoveBtn() {
            removeHighlightBtn.style.display = 'none';
            highlightTarget = null;
        }

        highlightBtn.addEventListener('click', () => {
            if (lastSelection) {
                const span = document.createElement('span');
                span.className = 'highlight';
                span.appendChild(lastSelection.extractContents());
                lastSelection.insertNode(span);
                window.getSelection().removeAllRanges();
                hideHighlightBtn();
            }
        });

        removeHighlightBtn.addEventListener('click', () => {
            if (highlightTarget) {
                const parent = highlightTarget.parentNode;
                while (highlightTarget.firstChild) {
                    parent.insertBefore(highlightTarget.firstChild, highlightTarget);
                }
                parent.removeChild(highlightTarget);
                hideRemoveBtn();
            }
        });

        document.addEventListener('selectionchange', () => {
            hideHighlightBtn();
            hideRemoveBtn();
            const range = getValidSelection();
            if (range) {
                lastSelection = range;
                showHighlightBtn(range);
            } else {
                lastSelection = null;
            }
        });

        [passagePanel, questionsPanel].forEach(panel => {
            panel.addEventListener('scroll', () => {
                hideHighlightBtn();
                hideRemoveBtn();
            });
        });

        document.addEventListener('mousedown', (e) => {
            if (e.target !== highlightBtn && e.target !== removeHighlightBtn) {
                hideHighlightBtn();
                hideRemoveBtn();
            }
        });

        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('highlight')) {
                e.preventDefault();
                showRemoveBtn(e.target);
            }
        });

        // Resizer
        resizer.addEventListener('mousedown', (e) => {
            isResizing = true;
            document.body.style.cursor = 'col-resize';
            document.body.style.userSelect = 'none';
        });

        document.addEventListener('mousemove', (e) => {
            if (!isResizing) return;
            const container = document.querySelector('.main-content');
            const containerRect = container.getBoundingClientRect();
            const mouseX = e.clientX - containerRect.left;
            const containerWidth = containerRect.width;
            const leftPercentage = (mouseX / containerWidth) * 100;
            const rightPercentage = 100 - leftPercentage;
            if (leftPercentage >= 30 && leftPercentage <= 70) {
                document.querySelector('.passage-container').style.flex = leftPercentage + '%';
                document.querySelector('.questions-container').style.width = rightPercentage + '%';
            }
        });

        document.addEventListener('mouseup', () => {
            if (isResizing) {
                isResizing = false;
                document.body.style.cursor = '';
                document.body.style.userSelect = '';
            }
        });

        // Navigation
        function scrollToQuestion(num) {
            const el = document.querySelector(`[data-question="${num}"]`);
            if (el) el.scrollIntoView({ behavior: 'smooth', block: 'center' });
            updateCurrentQuestion(num);
        }

        function updateCurrentQuestion(num) {
            currentQuestion = num;
            document.querySelectorAll('.progress-item').forEach(item => {
                item.classList.remove('current');
                if (item.dataset.question == num) item.classList.add('current');
            });
            prevBtn.disabled = num <= 27;
            nextBtn.disabled = num >= 40;
        }

        document.querySelectorAll('.progress-item').forEach(item => {
            item.addEventListener('click', () => {
                scrollToQuestion(parseInt(item.dataset.question));
            });
        });

        prevBtn.addEventListener('click', () => {
            if (currentQuestion > 27) scrollToQuestion(currentQuestion - 1);
        });

        nextBtn.addEventListener('click', () => {
            if (currentQuestion < 40) scrollToQuestion(currentQuestion + 1);
        });

        document.querySelectorAll('select, input[type="radio"]').forEach(input => {
            input.addEventListener('change', () => {
                if (submitted) return;
                const qNumMatch = input.name.match(/^q(\d+)$/);
                if (qNumMatch) {
                    const qNum = parseInt(qNumMatch[1]);
                    const item = document.querySelector(`.progress-item[data-question="${qNum}"]`);
                    if (item && !item.classList.contains('answered')) {
                        item.classList.add('answered');
                    }
                }
            });
        });

        submitBtn.addEventListener('click', submitTest);

        function submitTest() {
            if (submitted) return;
            if (!confirm('Are you sure you want to submit?')) return;
            submitted = true;
            clearInterval(timerInterval);
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<i class="fas fa-check"></i> Submitted';
            let score = 0;
            const results = {};
            for (let i = 27; i <= 40; i++) {
                const key = `q${i}`;
                let userAnswer = '';
                let isCorrect = false;
                const selectEl = document.querySelector(`select[name="${key}"]`);
                const radioEl = document.querySelector(`input[name="${key}"]:checked`);
                if (selectEl) {
                    userAnswer = selectEl.value;
                    isCorrect = userAnswer === correctAnswers[key];
                    selectEl.disabled = true;
                } else if (radioEl) {
                    userAnswer = radioEl.value;
                    isCorrect = userAnswer === correctAnswers[key];
                    document.querySelectorAll(`input[name="${key}"]`).forEach(r => r.disabled = true);
                }
                if (isCorrect) score++;
                results[key] = { userAnswer, correct: correctAnswers[key], isCorrect };
                console.log(`Question ${key}: User Answer = "${userAnswer}", Correct Answer = "${correctAnswers[key]}", Is Correct = ${isCorrect}`);
            }
            scoreDisplay.textContent = `${score}/14`;
            passage3Score.textContent = `${score}/14`;
            for (let i = 27; i <= 40; i++) {
                const item = document.querySelector(`.progress-item[data-question="${i}"]`);
                const res = results[`q${i}`];
                if (item && res) {
                    item.classList.remove('current', 'answered');
                    item.classList.add(res.isCorrect ? 'correct' : 'incorrect');
                }
            }
            window.testResults = results;
            resultsModal.style.display = 'flex';
        }

        function showCorrectAnswers() {
            if (!submitted) return;
            document.querySelectorAll('.answer-indicator').forEach(el => el.remove());
            for (let i = 27; i <= 40; i++) {
                const key = `q${i}`;
                const res = window.testResults[key];
                if (!res) {
                    console.error(`No result found for question ${key}`);
                    continue;
                }
                let targetElement;
                const selectEl = document.querySelector(`select[name="${key}"]`);
                const radioGroup = document.querySelector(`input[name="${key}"]`);
                if (selectEl) {
                    targetElement = selectEl.closest('.question');
                } else if (radioGroup) {
                    targetElement = radioGroup.closest('.question');
                }
                if (!targetElement) {
                    console.error(`No question container found for ${key}`);
                    continue;
                }
                const div = document.createElement('div');
                div.className = 'answer-indicator';
                div.classList.add(res.isCorrect ? 'correct' : 'incorrect');
                if (res.isCorrect) {
                    div.innerHTML = `<i class="fas fa-check"></i> Correct! You chose: <strong>${res.userAnswer || 'No answer'}</strong>`;
                } else {
                    const userDisplay = res.userAnswer || 'No answer';
                    div.innerHTML = `<i class="fas fa-times"></i> Incorrect. You chose: <strong>${userDisplay}</strong><br><strong>Correct:</strong> ${res.correct}`;
                }
                try {
                    targetElement.appendChild(div);
                } catch (e) {
                    console.error(`Error appending indicator for question ${key}: ${e.message}`);
                }
            }
        }

        closeModalBtn.addEventListener('click', () => {
            resultsModal.style.display = 'none';
        });

        reviewBtn.addEventListener('click', () => {
            resultsModal.style.display = 'none';
            showCorrectAnswers();
            scrollToQuestion(27);
        });

        function startTest() {
            document.getElementById('startScreen').classList.add('hidden');
            document.getElementById('testContainer').classList.remove('hidden');
            timerInterval = setInterval(updateTimer, 1000);
        }

        setTimeout(() => {
            document.getElementById('loadingScreen').classList.add('hidden');
            document.getElementById('startScreen').classList.remove('hidden');
        }, 2000);
    </script>

</body>

</html>