<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Art of Deception - Reading Passage</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --bg-color: #f8f9fa;
            --text-color: #333;
            --header-bg: #2c3e50;
            --header-text: #ecf0f1;
            --passage-bg: #ffffff;
            --questions-bg: #f1f5f9;
            --border-color: #3498db;
            --highlight-color: #ffeb3b;
            --correct-color: #2ecc71;
            --incorrect-color: #e74c3c;
            --progress-incomplete: #bdc3c7;
            --progress-complete: #2ecc71;
            --button-bg: #3498db;
            --button-hover: #2980b9;
            --timer-bg: #3498db;
            --timer-text: #fff;
        }

        .night-mode {
            --bg-color: #121212;
            --text-color: #e0e0e0;
            --header-bg: #1a1a1a;
            --header-text: #f5f5f5;
            --passage-bg: #1e1e1e;
            --questions-bg: #252525;
            --border-color: #424242;
            --highlight-color: #0084ff;
            --correct-color: #27ae60;
            --incorrect-color: #c0392b;
            --progress-incomplete: #616161;
            --progress-complete: #27ae60;
            --button-bg: #0088cc;
            --button-hover: #006699;
            --timer-bg: #0088cc;
            --timer-text: #f5f5f5;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            transition: background-color 0.3s, color 0.3s;
        }

        header {
            background-color: var(--header-bg);
            color: var(--header-text);
            padding: 12px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        .logo-area {
            display: flex;
            align-items: center;
        }

        .logo-area h1 {
            font-size: 1.2rem;
            font-weight: 600;
            margin-right: 15px;
        }

        .social-link {
            display: flex;
            align-items: center;
            gap: 8px;
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            text-decoration: none;
            background-color: #0088cc;
            font-weight: 500;
            transition: transform 0.2s, background-color 0.3s;
        }

        .social-link:hover {
            transform: translateY(-2px);
            background-color: #006699;
        }

        .header-controls {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .timer-container {
            background-color: var(--timer-bg);
            color: var(--timer-text);
            padding: 8px 15px;
            border-radius: 30px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .timer-controls {
            display: flex;
            gap: 8px;
        }

        .timer-controls button {
            background: none;
            border: none;
            color: var(--timer-text);
            cursor: pointer;
            font-size: 16px;
            padding: 4px;
            border-radius: 50%;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.3s;
        }

        .timer-controls button:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }

        .mode-toggle {
            background: none;
            border: none;
            color: var(--header-text);
            cursor: pointer;
            font-size: 20px;
            padding: 6px;
            border-radius: 50%;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.3s;
        }

        .mode-toggle:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .container {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        .passage-container,
        .questions-container {
            height: calc(100vh - 120px);
            overflow-y: auto;
            padding: 20px;
        }

        .passage-container {
            width: 50%;
            background-color: var(--passage-bg);
            border-right: 1px solid var(--border-color);
            position: relative;
        }

        .questions-container {
            width: 50%;
            background-color: var(--questions-bg);
            position: relative;
        }

        .passage-content {
            max-width: 800px;
            margin: 0 auto;
        }

        .passage-title {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--text-color);
            padding-bottom: 10px;
            border-bottom: 2px solid var(--border-color);
        }

        .instructions {
            background-color: rgba(52, 152, 219, 0.1);
            border-left: 4px solid var(--border-color);
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 0 4px 4px 0;
            font-size: 0.95rem;
        }

        .passage-text {
            font-size: 1.05rem;
            line-height: 1.7;
        }

        .passage-text p {
            margin-bottom: 20px;
            text-align: justify;
        }

        .highlight {
            background-color: var(--highlight-color);
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .section-title {
            font-size: 1.4rem;
            font-weight: 600;
            margin: 25px 0 15px;
            color: var(--text-color);
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border-color);
        }

        .question-group {
            margin-bottom: 30px;
        }

        .question {
            margin-bottom: 25px;
            padding: 20px;
            border-radius: 8px;
            background-color: var(--passage-bg);
            border-left: 4px solid var(--border-color);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        .question-title {
            font-weight: 600;
            margin-bottom: 15px;
            display: flex;
            align-items: flex-start;
        }

        .question-number {
            display: inline-flex;
            width: 32px;
            height: 32px;
            background-color: var(--progress-incomplete);
            color: white;
            border-radius: 50%;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            font-size: 16px;
            flex-shrink: 0;
        }

        .question.answered .question-number {
            background-color: var(--progress-complete);
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option {
            display: flex;
            align-items: flex-start;
            cursor: pointer;
            padding: 10px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }

        .option:hover {
            background-color: rgba(52, 152, 219, 0.1);
        }

        .option input {
            margin-right: 10px;
            margin-top: 3px;
        }

        .summary-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin: 20px 0;
        }

        .summary-options span {
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            text-align: center;
            font-size: 0.9rem;
        }

        .summary-input {
            display: inline-block;
            width: 120px;
            background: transparent;
            border: none;
            border-bottom: 2px solid var(--border-color);
            color: var(--text-color);
            font-family: inherit;
            font-size: 1em;
            padding: 0 4px 2px 4px;
            margin: 0 5px;
            text-align: center;
            outline: none;
            transition: border-color 0.3s;
        }

        .summary-input:focus {
            border-bottom-color: var(--button-bg);
        }

        footer {
            background-color: var(--header-bg);
            color: var(--header-text);
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-top: 1px solid var(--border-color);
        }

        .progress-container {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            max-width: 70%;
        }

        .progress-item {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: var(--progress-incomplete);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            cursor: pointer;
            transition: transform 0.2s, background-color 0.3s;
        }

        .progress-item:hover {
            transform: scale(1.1);
        }

        .progress-item.completed {
            background-color: var(--progress-complete);
        }

        .action-buttons {
            display: flex;
            gap: 12px;
        }

        button {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            transition: background-color 0.3s, transform 0.2s;
        }

        .btn-primary {
            background-color: var(--button-bg);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--button-hover);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background-color: transparent;
            border: 1px solid var(--button-bg);
            color: var(--button-bg);
        }

        .btn-secondary:hover {
            background-color: rgba(52, 152, 219, 0.1);
            transform: translateY(-2px);
        }

        .feedback-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            display: none;
            justify-content: center;
            align-items: center;
        }

        .feedback-container {
            background-color: var(--passage-bg);
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            border-radius: 10px;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .feedback-header {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: var(--header-bg);
            color: var(--header-text);
        }

        .feedback-title {
            font-size: 1.5rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        #close-feedback {
            font-size: 24px;
            background: none;
            border: none;
            color: var(--header-text);
            cursor: pointer;
        }

        .score-display {
            font-size: 1.8rem;
            font-weight: 700;
            margin-left: 10px;
            color: var(--highlight-color);
        }

        .feedback-body {
            padding: 20px;
            overflow-y: auto;
            max-height: 60vh;
        }

        .feedback-item {
            margin-bottom: 20px;
            padding: 15px;
            border-radius: 8px;
            background-color: var(--questions-bg);
        }

        .feedback-question {
            font-weight: 600;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .feedback-answer {
            padding: 10px;
            border-radius: 4px;
            margin-top: 8px;
        }

        .correct {
            background-color: rgba(46, 204, 113, 0.15);
            color: var(--correct-color);
            border: 1px solid var(--correct-color);
        }

        .incorrect {
            background-color: rgba(231, 76, 60, 0.15);
            color: var(--incorrect-color);
            border: 1px solid var(--incorrect-color);
        }

        .feedback-explanation {
            margin-top: 10px;
            padding: 10px;
            border-left: 3px solid var(--button-bg);
            background-color: rgba(52, 152, 219, 0.05);
        }

        /* Highlight Tooltip */
        .highlight-tooltip {
            position: absolute;
            background-color: #333;
            color: white;
            padding: 10px;
            border-radius: 4px;
            font-size: 14px;
            z-index: 1000;
            cursor: pointer;
            display: flex;
            gap: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .color-picker {
            display: flex;
            gap: 5px;
        }

        .color-option {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid white;
            transition: transform 0.2s;
        }

        .color-option:hover {
            transform: scale(1.1);
        }

        .remove-highlight {
            background-color: #e74c3c;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            margin-left: 5px;
        }

        @media (max-width: 900px) {
            .container {
                flex-direction: column;
            }

            .passage-container,
            .questions-container {
                width: 100%;
                height: auto;
                max-height: 50vh;
            }

            .passage-container {
                border-right: none;
                border-bottom: 1px solid var(--border-color);
            }

            .progress-container {
                max-width: 60%;
            }
        }

        @media (max-width: 768px) {
            header {
                flex-direction: column;
                gap: 15px;
                padding: 15px;
            }

            .header-controls {
                width: 100%;
                justify-content: space-between;
            }

            .progress-container {
                max-width: 100%;
                justify-content: center;
            }

            .progress-item {
                width: 30px;
                height: 30px;
                font-size: 12px;
            }

            footer {
                flex-direction: column;
                gap: 15px;
            }

            .action-buttons {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>

<body>
    <header>
        <div class="logo-area">
            <h1>IELTS Reading Test</h1>
            <a class="social-link" href="https://t.me/IELTSwithJurabek" target="_blank">
                <i class="fab fa-telegram-plane"></i>
                <span>IELTSwithJurabek</span>
            </a>
        </div>
        <div class="header-controls">
            <div class="timer-container">
                <i class="fas fa-clock"></i>
                <span id="timer">20:00</span>
                <div class="timer-controls">
                    <button id="start-timer" title="Start"><i class="fas fa-play"></i></button>
                    <button id="pause-timer" title="Pause"><i class="fas fa-pause"></i></button>
                    <button id="reset-timer" title="Reset"><i class="fas fa-redo"></i></button>
                </div>
            </div>
            <button class="mode-toggle" id="night-mode-toggle" title="Toggle Night Mode">
                <i class="fas fa-moon"></i>
            </button>
        </div>
    </header>

    <div class="container">
        <div class="passage-container">
            <div class="passage-content">
                <div class="passage-title">The Art of Deception</div>
                <div class="instructions">
                    <p><strong>You should spend about 20 minutes on Questions 27-40, which are based on Reading Passage
                            3.</strong></p>
                </div>
                <div class="passage-text" id="passage-text">
                    <p><strong>1</strong> Forty years ago, the research psychologist Dr Paul Ekman was addressing a
                        group of young psychiatrists in training when he was asked a question, the answer to which has
                        kept him busy ever since. Suppose the group wanted to know, a particular patient swears they are
                        telling the truth. They look and sound sincere. So here is the question: is there any way you
                        can be sure they are telling the truth? Ekman did not know the answer then, but wanted to find
                        out.</p>

                    <p><strong>2</strong> As part of his research, he had already filmed a series of 12-minute
                        interviews with psychiatric patients. In a subsequent conversation, one of the patients told him
                        that she had lied to him. So, Ekman sat and looked at the film but saw nothing noteworthy. Then
                        he slowed it down and looked again. Then he slowed it even further. And suddenly, there, across
                        just two frames of the film, he saw it: an intense expression of extreme anguish. It lasted less
                        than a 15th of a second, but once he had spotted the first expression, he soon found three more
                        examples in that same interview. He termed his discovery "micro-expression": very rapid intense
                        demonstrations of emotion that the subject intended to be concealed.</p>

                    <p><strong>3</strong> Over the course of the next four decades, Ekman successfully demonstrated a
                        proposition first suggested by Charles Darwin: that the ways in which we express rage, disgust,
                        contempt, fear, surprise, happiness and sadness are universal. The facial muscles triggered by
                        those seven basic emotions are, he has shown, essentially standard, regardless of language and
                        culture, from the US to Japan and Brazil to Papua New Guinea. What is more, expressions of
                        emotion are impossible to suppress and, particularly when we are lying, micro-expressions of
                        powerfully felt emotions will inevitably flit across our face before we get the chance to stop
                        them.</p>

                    <p><strong>4</strong> Fortunately for liars, most people will fail to spot these fleeting signals of
                        inner torment. Of the 15,000 Ekman has tested, only 50 people, whom he calls "naturals", have
                        been able to do it. But given a little more training, Ekman says, almost anyone can develop the
                        skill. He should know, since these tests were completed in the mid-1980s and the first
                        publication of his research, he has been called in by the FBI and CIA (among countless more
                        law-enforcement and other agencies around the world), not just to solve cases, but to teach them
                        how to use his technique for themselves. He has held workshops for defense and prosecution
                        lawyers, health professionals, even jealous spouses, all of them wanting to know exactly when
                        someone is not being 100 percent candid.</p>

                    <p><strong>5</strong> Most recently, Ekman's research has resulted in a new television series about
                        the exploits of the fictional Dr Cal Lightman, a scientist who studies involuntary body language
                        to discover not only if you are lying. But why might you have been motivated to do so? According
                        to the publicity blurb, Lightman is a human lie detector, even more accurate than a polygraph
                        test. Ekman concedes he was skeptical when the producer first approached him with the idea of
                        turning his life's work into a TV series, and initially would have stopped the project if he
                        could. In particular, he was fearful that the show would exaggerate the effectiveness of his
                        techniques and create the quite inaccurate impression among audiences that criminals could no
                        longer hope to get away with lying. In the worst-case scenario, he was concerned about unfair
                        convictions, that one day someone not properly trained in his techniques might be sitting on a
                        jury and wrongly find someone guilty of a crime simply on the basis of a television programme.
                    </p>

                    <p><strong>6</strong> In the end though, he was won over because the series is unusual in several
                        respects. It is the first time, as far as Ekman is aware, that a commercial TV drama has been
                        based on the work of just one scientist. That scientist is also deeply involved in the project,
                        talking through plot ideas and checking five successive drafts of each script to ensure details
                        are correct. He was also impressed with the producer's manifestly serious and well-intentioned
                        reasons for making the programme. Now that the first series has been completed, he believes
                        probably 80-90 per cent of the show is based on fact and that's good enough for what is. After
                        all, a drama, not a documentary.</p>

                    <p><strong>7</strong> Ekman, incidentally, professes to have been a terrible liar ever since he was
                        a small boy and observes that the ability to detect a lie and the ability to lie successfully
                        are completely unrelated. He has been asked by people running for high office if he could teach
                        them to become more credible with the public but has always refused to use his skills in that
                        way on ethical grounds. He also insists that there are various kinds of lies. A "true" lie can
                        be identified by having two essential characteristics: there must be a deliberate intent to
                        mislead and there must be no notification that this is what is occurring. This means that an
                        actor or a poker player isn't a true liar. They are supposed to deceive you, it's part of the
                        game, and the same is true of flattery. He prefers to focus on the kinds of lies where the liar
                        would be in grave trouble if they were found out, and where the target would feel properly
                        aggrieved if they knew.</p>
                </div>
            </div>
        </div>

        <div class="questions-container">
            <div class="section-title">Questions 27-31</div>
            <div class="instructions">
                <p>Choose the correct letter <strong>A, B, C</strong> or <strong>D</strong>.</p>
                <p>Write the correct letter in boxes 27-31 on your answer sheet.</p>
            </div>
            <div class="question-group">
                <div class="question" id="q27">
                    <div class="question-title">
                        <div class="question-number">27</div>
                        <div class="question-text">According to the writer, Ekman became interested in lying after a
                            question from his</div>
                    </div>
                    <div class="options">
                        <label class="option">
                            <input type="radio" name="q27" value="A">
                            A peers.
                        </label>
                        <label class="option">
                            <input type="radio" name="q27" value="B">
                            B patients.
                        </label>
                        <label class="option">
                            <input type="radio" name="q27" value="C">
                            C students.
                        </label>
                        <label class="option">
                            <input type="radio" name="q27" value="D">
                            D teachers.
                        </label>
                    </div>
                </div>

                <div class="question" id="q28">
                    <div class="question-title">
                        <div class="question-number">28</div>
                        <div class="question-text">The writer refers to the 12-minute interviews in order to</div>
                    </div>
                    <div class="options">
                        <label class="option">
                            <input type="radio" name="q28" value="A">
                            A illustrate how frequently patients lie.
                        </label>
                        <label class="option">
                            <input type="radio" name="q28" value="B">
                            B describe the origins of Ekman's theories.
                        </label>
                        <label class="option">
                            <input type="radio" name="q28" value="C">
                            C compare Ekman's research to previous studies.
                        </label>
                        <label class="option">
                            <input type="radio" name="q28" value="D">
                            D show how patients behaviour is affected by filming.
                        </label>
                    </div>
                </div>

                <div class="question" id="q29">
                    <div class="question-title">
                        <div class="question-number">29</div>
                        <div class="question-text">What is the writer's point in the third paragraph?</div>
                    </div>
                    <div class="options">
                        <label class="option">
                            <input type="radio" name="q29" value="A">
                            A Micro-expressions are common to all people.
                        </label>
                        <label class="option">
                            <input type="radio" name="q29" value="B">
                            B Recent research has refuted an old idea.
                        </label>
                        <label class="option">
                            <input type="radio" name="q29" value="C">
                            C With practice we can learn to control our micro-expression.
                        </label>
                        <label class="option">
                            <input type="radio" name="q29" value="D">
                            D Human society is too complex to allow for generalisations.
                        </label>
                    </div>
                </div>

                <div class="question" id="q30">
                    <div class="question-title">
                        <div class="question-number">30</div>
                        <div class="question-text">What are we told about Ekman's conclusions from his tests?</div>
                    </div>
                    <div class="options">
                        <label class="option">
                            <input type="radio" name="q30" value="A">
                            A It's natural for people to lie.
                        </label>
                        <label class="option">
                            <input type="radio" name="q30" value="B">
                            B Few untrained people can detect lying.
                        </label>
                        <label class="option">
                            <input type="radio" name="q30" value="C">
                            C Most liars suffer from periods of depression.
                        </label>
                        <label class="option">
                            <input type="radio" name="q30" value="D">
                            D All of his subjects were trained to identify micro-expressions.
                        </label>
                    </div>
                </div>

                <div class="question" id="q31">
                    <div class="question-title">
                        <div class="question-number">31</div>
                        <div class="question-text">What point does the writer make about Ekman's techniques in the
                            fourth paragraph?</div>
                    </div>
                    <div class="options">
                        <label class="option">
                            <input type="radio" name="q31" value="A">
                            A They take a decade to teach.
                        </label>
                        <label class="option">
                            <input type="radio" name="q31" value="B">
                            B They have been in great demand.
                        </label>
                        <label class="option">
                            <input type="radio" name="q31" value="C">
                            C They have aroused the suspicions of some agencies.
                        </label>
                        <label class="option">
                            <input type="radio" name="q31" value="D">
                            D They can be used by a limited range of occupations.
                        </label>
                    </div>
                </div>
            </div>

            <div class="section-title">Questions 32-36</div>
            <div class="instructions">
                <p>Complete the summary using the list of words, <strong>A-I</strong>, below.</p>
                <p>Write the correct letter, <strong>A-I</strong>, in boxes 32-36 on your answer sheet.</p>
            </div>
            <div class="question-group">
                <div class="question">
                    <div class="question-title">
                        <div class="question-text">
                            <p><strong>The television series based on Ekman's work</strong></p>
                            <p>A new TV series based on Ekman's work features a hero named Lightman, who detects lies.
                                Initially, Ekman was unenthusiastic about the TV project because he feared the
                                possibility of encouraging viewers'
                                <select id="q32" class="summary-input">
                                    <option value="">Select</option>
                                    <option value="A">A consequences</option>
                                    <option value="B">B crimes</option>
                                    <option value="C">C false beliefs</option>
                                    <option value="D">D motives</option>
                                    <option value="E">E justice</option>
                                    <option value="F">F accuracy</option>
                                    <option value="G">G acting</option>
                                    <option value="H">H research</option>
                                    <option value="I">I ratings</option>
                                </select>. For example, he was worried that one day the programme could result in
                                <select id="q33" class="summary-input">
                                    <option value="">Select</option>
                                    <option value="A">A consequences</option>
                                    <option value="B">B crimes</option>
                                    <option value="C">C false beliefs</option>
                                    <option value="D">D motives</option>
                                    <option value="E">E justice</option>
                                    <option value="F">F accuracy</option>
                                    <option value="G">G acting</option>
                                    <option value="H">H research</option>
                                    <option value="I">I ratings</option>
                                </select> not being carried out. Ultimately though, he has given the show his blessing
                                because he is not aware of any other comparable programme based on a single person's
                                <select id="q34" class="summary-input">
                                    <option value="">Select</option>
                                    <option value="A">A consequences</option>
                                    <option value="B">B crimes</option>
                                    <option value="C">C false beliefs</option>
                                    <option value="D">D motives</option>
                                    <option value="E">E justice</option>
                                    <option value="F">F accuracy</option>
                                    <option value="G">G acting</option>
                                    <option value="H">H research</option>
                                    <option value="I">I ratings</option>
                                </select>. The
                                <select id="q35" class="summary-input">
                                    <option value="">Select</option>
                                    <option value="A">A consequences</option>
                                    <option value="B">B crimes</option>
                                    <option value="C">C false beliefs</option>
                                    <option value="D">D motives</option>
                                    <option value="E">E justice</option>
                                    <option value="F">F accuracy</option>
                                    <option value="G">G acting</option>
                                    <option value="H">H research</option>
                                    <option value="I">I ratings</option>
                                </select> of the show's producer have been another pleasant surprise considering the
                                genre of the programme. Ekman is happy with the show's overall
                                <select id="q36" class="summary-input">
                                    <option value="">Select</option>
                                    <option value="A">A consequences</option>
                                    <option value="B">B crimes</option>
                                    <option value="C">C false beliefs</option>
                                    <option value="D">D motives</option>
                                    <option value="E">E justice</option>
                                    <option value="F">F accuracy</option>
                                    <option value="G">G acting</option>
                                    <option value="H">H research</option>
                                    <option value="I">I ratings</option>
                                </select>.
                            </p>
                        </div>
                    </div>
                </div>

                <div class="summary-options">
                    <span>A consequences</span>
                    <span>B crimes</span>
                    <span>C false beliefs</span>
                    <span>D motives</span>
                    <span>E justice</span>
                    <span>F accuracy</span>
                    <span>G acting</span>
                    <span>H research</span>
                    <span>I ratings</span>
                </div>
            </div>

            <div class="section-title">Questions 37-40</div>
            <div class="instructions">
                <p>Do the following statements agree with the claims of the writer in Reading Passage 3?</p>
                <p>In boxes 37-40 on your answer sheet, write:</p>
                <p><strong>YES</strong> - if the statement agrees with the claims of the writer<br>
                    <strong>NO</strong> - if the statement contradicts the claims of the writer<br>
                    <strong>NOT GIVEN</strong> - if it is impossible to say what the writer thinks about this
                </p>
            </div>
            <div class="question-group">
                <div class="question" id="q37">
                    <div class="question-title">
                        <div class="question-number">37</div>
                        <div class="question-text">Ekman regrets the lies he told as a child.</div>
                    </div>
                    <div class="options">
                        <label class="option">
                            <input type="radio" name="q37" value="YES">
                            YES
                        </label>
                        <label class="option">
                            <input type="radio" name="q37" value="NO">
                            NO
                        </label>
                        <label class="option">
                            <input type="radio" name="q37" value="NOT GIVEN">
                            NOT GIVEN
                        </label>
                    </div>
                </div>

                <div class="question" id="q38">
                    <div class="question-title">
                        <div class="question-number">38</div>
                        <div class="question-text">People who are good at lying tend to be good at detecting lies.</div>
                    </div>
                    <div class="options">
                        <label class="option">
                            <input type="radio" name="q38" value="YES">
                            YES
                        </label>
                        <label class="option">
                            <input type="radio" name="q38" value="NO">
                            NO
                        </label>
                        <label class="option">
                            <input type="radio" name="q38" value="NOT GIVEN">
                            NOT GIVEN
                        </label>
                    </div>
                </div>

                <div class="question" id="q39">
                    <div class="question-title">
                        <div class="question-number">39</div>
                        <div class="question-text">Ekman has worked with poker players to help them lie more
                            convincingly.</div>
                    </div>
                    <div class="options">
                        <label class="option">
                            <input type="radio" name="q39" value="YES">
                            YES
                        </label>
                        <label class="option">
                            <input type="radio" name="q39" value="NO">
                            NO
                        </label>
                        <label class="option">
                            <input type="radio" name="q39" value="NOT GIVEN">
                            NOT GIVEN
                        </label>
                    </div>
                </div>

                <div class="question" id="q40">
                    <div class="question-title">
                        <div class="question-number">40</div>
                        <div class="question-text">Ekman is more interested in the types of lies with serious
                            consequences.</div>
                    </div>
                    <div class="options">
                        <label class="option">
                            <input type="radio" name="q40" value="YES">
                            YES
                        </label>
                        <label class="option">
                            <input type="radio" name="q40" value="NO">
                            NO
                        </label>
                        <label class="option">
                            <input type="radio" name="q40" value="NOT GIVEN">
                            NOT GIVEN
                        </label>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <div class="progress-container" id="progress-container"></div>
        <div class="action-buttons">
            <button class="btn-secondary" id="reset-btn">Reset Answers</button>
            <button class="btn-primary" id="submit-btn">Submit Answers</button>
        </div>
    </footer>

    <div class="feedback-overlay" id="feedback-overlay">
        <div class="feedback-container">
            <div class="feedback-header">
                <div class="feedback-title">
                    <i class="fas fa-chart-bar"></i> Your Results
                    <span class="score-display" id="score-display">0/14</span>
                </div>
                <button id="close-feedback"><i class="fas fa-times"></i></button>
            </div>
            <div class="feedback-body" id="feedback-body">
                <!-- Feedback will be inserted here -->
            </div>
        </div>
    </div>

    <script>
        // Night mode toggle
        document.getElementById('night-mode-toggle').addEventListener('click', function () {
            document.body.classList.toggle('night-mode');
            const icon = this.querySelector('i');
            if (document.body.classList.contains('night-mode')) {
                icon.classList.remove('fa-moon');
                icon.classList.add('fa-sun');
            } else {
                icon.classList.remove('fa-sun');
                icon.classList.add('fa-moon');
            }
        });

        // Timer functionality
        let timerInterval;
        let timeRemaining = 20 * 60; // 20 minutes

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60).toString().padStart(2, '0');
            const seconds = (timeRemaining % 60).toString().padStart(2, '0');
            document.getElementById("timer").textContent = `${minutes}:${seconds}`;
        }

        document.getElementById("start-timer").addEventListener("click", () => {
            if (timerInterval) return;
            timerInterval = setInterval(() => {
                if (timeRemaining > 0) {
                    timeRemaining--;
                    updateTimerDisplay();
                } else {
                    clearInterval(timerInterval);
                    timerInterval = null;
                    alert("Time is up!");
                }
            }, 1000);
        });

        document.getElementById("pause-timer").addEventListener("click", () => {
            clearInterval(timerInterval);
            timerInterval = null;
        });

        document.getElementById("reset-timer").addEventListener("click", () => {
            clearInterval(timerInterval);
            timerInterval = null;
            timeRemaining = 20 * 60;
            updateTimerDisplay();
        });

        // Initialize timer display
        updateTimerDisplay();

        // Progress tracker initialization
        function initializeProgressTracker() {
            const progressContainer = document.getElementById("progress-container");
            const questions = [
                { id: 'q27', number: 27 },
                { id: 'q28', number: 28 },
                { id: 'q29', number: 29 },
                { id: 'q30', number: 30 },
                { id: 'q31', number: 31 },
                { id: 'q32', number: 32 },
                { id: 'q33', number: 33 },
                { id: 'q34', number: 34 },
                { id: 'q35', number: 35 },
                { id: 'q36', number: 36 },
                { id: 'q37', number: 37 },
                { id: 'q38', number: 38 },
                { id: 'q39', number: 39 },
                { id: 'q40', number: 40 }
            ];

            questions.forEach(({ id, number }) => {
                const item = document.createElement("div");
                item.className = "progress-item";
                item.textContent = number;
                item.dataset.qid = id;

                item.addEventListener("click", () => {
                    document.getElementById(id).scrollIntoView({ behavior: "smooth" });
                });

                progressContainer.appendChild(item);
            });
        }

        // Update progress status
        function updateProgressStatus() {
            const progressItems = document.querySelectorAll(".progress-item");

            progressItems.forEach(item => {
                const qid = item.dataset.qid;
                const questionElem = document.getElementById(qid);
                let answered = false;

                // For radio inputs
                const radios = document.querySelectorAll(`input[name="${qid}"]`);
                if (radios.length > 0) {
                    radios.forEach(r => {
                        if (r.checked) answered = true;
                    });
                }
                // For select inputs
                else if (questionElem.tagName === "SELECT") {
                    answered = questionElem.value !== "";
                }

                // Update progress item
                if (answered) {
                    item.classList.add("completed");
                    // Also mark the question container as answered
                    if (questionElem.closest('.question')) {
                        questionElem.closest('.question').classList.add("answered");
                    }
                } else {
                    item.classList.remove("completed");
                    if (questionElem.closest('.question')) {
                        questionElem.closest('.question').classList.remove("answered");
                    }
                }
            });
        }

        // Initialize progress tracker
        document.addEventListener("DOMContentLoaded", () => {
            initializeProgressTracker();
            updateProgressStatus();
        });

        // Listen for changes to update progress
        document.addEventListener("change", updateProgressStatus);

        // Submit answers and show feedback
        document.getElementById('submit-btn').addEventListener('click', function () {
            // Correct answers
            const correctAnswers = {
                q27: "C",
                q28: "B",
                q29: "A",
                q30: "B",
                q31: "B",
                q32: "C",
                q33: "E",
                q34: "H",
                q35: "D",
                q36: "F",
                q37: "NOT GIVEN",
                q38: "NO",
                q39: "NOT GIVEN",
                q40: "YES"
            };

            let score = 0;
            let feedbackHTML = "";

            // Check each question
            for (const [qid, correct] of Object.entries(correctAnswers)) {
                let userAnswer = "";
                const questionElem = document.getElementById(qid);

                // For radio inputs
                const radios = document.querySelectorAll(`input[name="${qid}"]`);
                if (radios.length > 0) {
                    radios.forEach(r => {
                        if (r.checked) userAnswer = r.value;
                    });
                }
                // For select inputs
                else if (questionElem.tagName === "SELECT") {
                    userAnswer = questionElem.value;
                }

                const isCorrect = userAnswer === correct;
                if (isCorrect) score++;

                // Build feedback item
                feedbackHTML += `
                <div class="feedback-item">
                    <div class="feedback-question">
                        <span class="question-number">${qid.replace("q", "")}</span>
                        Question ${qid.replace("q", "")}
                    </div>
                    <div class="feedback-answer ${isCorrect ? "correct" : "incorrect"}">
                        Your answer: <strong>${userAnswer || "Not answered"}</strong><br>
                        Correct answer: <strong>${correct}</strong>
                    </div>
                </div>`;
            }

            // Update feedback content
            document.getElementById("feedback-body").innerHTML = feedbackHTML;
            document.getElementById("score-display").textContent = `${score}/14`;

            // Show feedback overlay
            document.getElementById("feedback-overlay").style.display = "flex";
        });

        // Close feedback overlay
        document.getElementById("close-feedback").addEventListener("click", function () {
            document.getElementById("feedback-overlay").style.display = "none";
        });

        // Reset button
        document.getElementById("reset-btn").addEventListener("click", function () {
            // Reset all inputs
            const radios = document.querySelectorAll("input[type='radio']");
            radios.forEach(radio => radio.checked = false);

            const selects = document.querySelectorAll("select");
            selects.forEach(select => select.value = "");

            // Reset progress
            const progressItems = document.querySelectorAll(".progress-item.completed");
            progressItems.forEach(item => item.classList.remove("completed"));

            const answeredQuestions = document.querySelectorAll(".question.answered");
            answeredQuestions.forEach(q => q.classList.remove("answered"));

            // Reset timer
            clearInterval(timerInterval);
            timerInterval = null;
            timeRemaining = 20 * 60;
            updateTimerDisplay();

            // Remove all highlights
            document.querySelectorAll('.highlight').forEach(highlight => {
                const parent = highlight.parentNode;
                while (highlight.firstChild) {
                    parent.insertBefore(highlight.firstChild, highlight);
                }
                parent.removeChild(highlight);
            });
        });

        // Highlight functionality
        let highlightTooltip = null;
        let selectedRange = null;

        function createColorPicker(x, y) {
            const picker = document.createElement("div");
            picker.className = "highlight-tooltip";
            picker.style.position = "absolute";
            picker.style.top = `${y}px`;
            picker.style.left = `${x}px`;
            picker.style.zIndex = "1000";

            // Create color options
            const colors = ["#FFEB3B", "#81C784", "#64B5F6", "#FFA726"]; // Yellow, Green, Blue, Orange
            colors.forEach(color => {
                const colorOption = document.createElement("div");
                colorOption.className = "color-option";
                colorOption.style.backgroundColor = color;
                colorOption.title = `Highlight with ${color}`;
                colorOption.addEventListener("click", () => {
                    applyHighlight(color);
                    picker.remove();
                    highlightTooltip = null;
                });
                picker.appendChild(colorOption);
            });

            document.body.appendChild(picker);
            return picker;
        }

        function applyHighlight(color) {
            if (!selectedRange) return;

            const span = document.createElement("span");
            span.className = "highlight";
            span.style.backgroundColor = color;
            span.appendChild(selectedRange.extractContents());
            selectedRange.insertNode(span);

            selectedRange = null;
            window.getSelection().removeAllRanges();

            // Add click event to remove highlight
            span.addEventListener("click", function (e) {
                e.stopPropagation();

                if (highlightTooltip) {
                    highlightTooltip.remove();
                    highlightTooltip = null;
                }

                highlightTooltip = document.createElement("div");
                highlightTooltip.className = "highlight-tooltip";
                highlightTooltip.style.position = "absolute";
                highlightTooltip.style.top = `${e.clientY}px`;
                highlightTooltip.style.left = `${e.clientX}px`;
                highlightTooltip.style.zIndex = "1000";

                const removeBtn = document.createElement("button");
                removeBtn.className = "remove-highlight";
                removeBtn.textContent = "Remove Highlight";
                removeBtn.addEventListener("click", function () {
                    const parent = span.parentNode;
                    while (span.firstChild) {
                        parent.insertBefore(span.firstChild, span);
                    }
                    parent.removeChild(span);
                    highlightTooltip.remove();
                    highlightTooltip = null;
                });

                highlightTooltip.appendChild(removeBtn);
                document.body.appendChild(highlightTooltip);
            });
        }

        // Handle mouseup events for text selection in both areas
        function handleMouseUp(e) {
            // Ignore selections in form elements
            if (e.target.tagName === 'INPUT' || e.target.tagName === 'SELECT' || e.target.tagName === 'BUTTON') {
                return;
            }

            const selection = window.getSelection();
            if (selection.toString().trim() === "") return;

            selectedRange = selection.getRangeAt(0).cloneRange();
            const rect = selectedRange.getBoundingClientRect();

            if (highlightTooltip) {
                highlightTooltip.remove();
                highlightTooltip = null;
            }

            highlightTooltip = createColorPicker(
                rect.left + window.scrollX,
                rect.top + window.scrollY - 50
            );
        }

        // Add event listeners to both containers
        document.getElementById("passage-text").addEventListener("mouseup", handleMouseUp);
        document.querySelector(".questions-container").addEventListener("mouseup", handleMouseUp);

        // Close highlight tooltip when clicking elsewhere
        document.addEventListener("mousedown", function (e) {
            if (highlightTooltip && !highlightTooltip.contains(e.target)) {
                highlightTooltip.remove();
                highlightTooltip = null;
            }
        });
    </script>
</body>

</html>